import{r,j as d}from"./react-vendor-dWzucQ.js";class h{_masterVolume=1;_musicVolume=.7;_sfxVolume=.8;_muted=!1;_currentMusicTrack=null;_fallbackMode=!1;currentMusic=null;soundCache=new Map;_isInitialized=!1;constructor(e){e&&(this._masterVolume=e.masterVolume??1,this._musicVolume=e.musicVolume??.7,this._sfxVolume=e.sfxVolume??.8)}get isInitialized(){return this._isInitialized}get fallbackMode(){return this._fallbackMode}get currentMusicTrack(){return this._currentMusicTrack}get masterVolume(){return this._masterVolume}get sfxVolume(){return this._sfxVolume}get musicVolume(){return this._musicVolume}get muted(){return this._muted}async initialize(e){try{new(window.AudioContext||window.webkitAudioContext),this._isInitialized=!0,this._fallbackMode=!1,e&&(this._masterVolume=e.masterVolume??this._masterVolume,this._musicVolume=e.musicVolume??this._musicVolume,this._sfxVolume=e.sfxVolume??this._sfxVolume)}catch{this._isInitialized=!0,this._fallbackMode=!0}}async loadAsset(e){try{const t=new Audio(e.url);t.volume=e.volume||1,t.preload="auto",this.soundCache.set(e.id,t)}catch{}}async playSoundEffect(e){if(this._muted)return;const t=this.soundCache.get(e);if(t)try{t.currentTime=0,t.volume=this._sfxVolume*this._masterVolume,await t.play()}catch{}}async playSFX(e,t){if(this._muted)return;const s=this.soundCache.get(e);if(s)try{s.currentTime=0,s.volume=(t??this._sfxVolume)*this._masterVolume,await s.play()}catch{}}async playMusic(e,t){if(this._muted)return;this.stopMusic();const s=this.soundCache.get(e);if(s)try{s.currentTime=0,s.volume=(t??this._musicVolume)*this._masterVolume,s.loop=!0,this.currentMusic=s,this._currentMusicTrack=e,await s.play()}catch{}}stopMusic(){this.currentMusic&&(this.currentMusic.pause(),this.currentMusic.currentTime=0,this.currentMusic=null,this._currentMusicTrack=null)}stopAll(){this.stopMusic(),this.soundCache.forEach(e=>{e.paused||(e.pause(),e.currentTime=0)})}setVolume(e,t){const s=Math.max(0,Math.min(1,t));switch(e){case"master":this._masterVolume=s;break;case"sfx":this._sfxVolume=s;break;case"music":this._musicVolume=s,this.currentMusic&&(this.currentMusic.volume=this._musicVolume*this._masterVolume);break}}mute(){this._muted=!0,this.currentMusic&&(this.currentMusic.volume=0)}unmute(){this._muted=!1,this.currentMusic&&(this.currentMusic.volume=this._musicVolume*this._masterVolume)}async fadeOut(e=1e3){if(this.currentMusic)return new Promise(t=>{const u=this.currentMusic.volume/(e/50),o=setInterval(()=>{this.currentMusic&&this.currentMusic.volume>0?this.currentMusic.volume=Math.max(0,this.currentMusic.volume-u):(clearInterval(o),this.stopMusic(),t())},50)})}async fadeIn(e,t=1e3){if(await this.playMusic(e,0),!!this.currentMusic)return new Promise(s=>{const u=this._musicVolume*this._masterVolume,o=u/(t/50),l=setInterval(()=>{this.currentMusic&&this.currentMusic.volume<u?this.currentMusic.volume=Math.min(u,this.currentMusic.volume+o):(clearInterval(l),s())},50)})}async crossfade(e,t,s=1e3){await this.fadeOut(s),await this.fadeIn(t,s)}getLoadedAssets(){return new Map(this.soundCache)}async playVoice(e){return this.playSoundEffect(e)}async playKoreanTechniqueSound(e,t){const s=`${t}_${e}`;return this.playSoundEffect(s)}async playTrigramStanceSound(e){const t=`stance_${e}`;return this.playSoundEffect(t)}async playVitalPointHitSound(e){const t=`vital_point_${e}`;return this.playSoundEffect(t)}async playDojiangAmbience(){return this.playMusic("dojang_ambience")}getMasterVolume(){return this._masterVolume}getMusicVolume(){return this._musicVolume}getSfxVolume(){return this._sfxVolume}get initialized(){return this._isInitialized}}var a=(i=>(i.SFX="sfx",i.MUSIC="music",i.VOICE="voice",i.UI="ui",i))(a||{});const p=[{id:"attack_light",name:"Light Attack",type:"sound",url:"/assets/audio/sfx/attack_light.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:a.SFX,pitch:1},{id:"attack_medium",name:"Medium Attack",type:"sound",url:"/assets/audio/sfx/attack_medium.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:a.SFX,pitch:1},{id:"attack_heavy",name:"Heavy Attack",type:"sound",url:"/assets/audio/sfx/attack_heavy.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:a.SFX,pitch:.8},{id:"stance_change",name:"Stance Change",type:"sound",url:"/assets/audio/sfx/stance_change.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.6,category:a.SFX,pitch:1.2},{id:"block_success",name:"Successful Block",type:"sound",url:"/assets/audio/sfx/block_success.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:a.SFX,pitch:1.1},{id:"vital_hit_critical",name:"Critical Vital Point Hit",type:"sound",url:"/assets/audio/sfx/vital_hit_critical.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:a.SFX,pitch:.8}],f=[{id:"intro_theme",name:"Black Trigram Theme",type:"music",url:"/assets/audio/music/intro_theme.mp3",formats:["audio/mp3","audio/webm"],loaded:!1,title:{korean:"흑괘 테마",english:"Black Trigram Theme"},volume:.7,loop:!0,category:a.MUSIC,bpm:90},{id:"combat_theme",name:"Combat Music",type:"music",url:"/assets/audio/music/combat_theme.mp3",formats:["audio/mp3","audio/webm"],loaded:!1,title:{korean:"전투 음악",english:"Combat Music"},volume:.8,loop:!0,category:a.MUSIC,bpm:140},{id:"dojang_ambience",name:"Dojang Atmosphere",type:"music",url:"/assets/audio/music/dojang_ambience.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,title:{korean:"도장 분위기",english:"Dojang Atmosphere"},volume:.4,loop:!0,category:"music",bpm:60}],m=[{id:"musa_theme",name:"Traditional Warrior",type:"music",url:"/assets/audio/music/archetype_themes/musa_warrior.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"무사의 테마",english:"Warrior's Theme"},volume:.8,loop:!0,category:a.MUSIC,bpm:120},{id:"amsalja_theme",name:"Shadow Assassin",type:"music",url:"/assets/audio/music/archetype_themes/amsalja_shadow.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"암살자의 테마",english:"Assassin's Theme"},volume:.7,loop:!0,category:a.MUSIC,bpm:160},{id:"hacker_theme",name:"Cyber Warrior",type:"music",url:"/assets/audio/music/archetype_themes/hacker_cyber.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"해커의 테마",english:"Hacker's Theme"},volume:.8,loop:!0,category:a.MUSIC,bpm:180},{id:"jeongbo_theme",name:"Intelligence Operative",type:"music",url:"/assets/audio/music/archetype_themes/jeongbo_intel.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"정보요원의 테마",english:"Intelligence Theme"},volume:.7,loop:!0,category:a.MUSIC,bpm:100},{id:"jojik_theme",name:"Organized Crime",type:"music",url:"/assets/audio/music/archetype_themes/jojik_street.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"조직폭력배의 테마",english:"Crime Fighter's Theme"},volume:.8,loop:!0,category:a.MUSIC,bpm:140}],c=[{id:"geon_technique",name:"Heaven Technique",type:"sound",url:"/assets/audio/sfx/techniques/geon_heaven.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:a.SFX,pitch:1},{id:"tae_technique",name:"Lake Technique",type:"sound",url:"/assets/audio/sfx/techniques/tae_lake.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:a.SFX,pitch:1.1},{id:"li_technique",name:"Fire Technique",type:"sound",url:"/assets/audio/sfx/techniques/li_fire.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:a.SFX,pitch:1.3},{id:"jin_technique",name:"Thunder Technique",type:"sound",url:"/assets/audio/sfx/techniques/jin_thunder.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:a.SFX,pitch:.9},{id:"son_technique",name:"Wind Technique",type:"sound",url:"/assets/audio/sfx/techniques/son_wind.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.6,category:a.SFX,pitch:1.4},{id:"gam_technique",name:"Water Technique",type:"sound",url:"/assets/audio/sfx/techniques/gam_water.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:a.SFX,pitch:.8},{id:"gan_technique",name:"Mountain Technique",type:"sound",url:"/assets/audio/sfx/techniques/gan_mountain.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:a.SFX,pitch:.7},{id:"gon_technique",name:"Earth Technique",type:"sound",url:"/assets/audio/sfx/techniques/gon_earth.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:a.SFX,pitch:.6}],_=[...p,...c],y=[...f,...m],v={soundEffects:_,musicTracks:y,techniques:c,archetypeThemes:m},n=r.createContext(null),M=()=>{const i=r.useContext(n);if(!i)throw new Error("useAudio must be inside AudioProvider");return i},V=({children:i,config:e,manager:t})=>{const[s]=r.useState(()=>t||new h(e));return r.useEffect(()=>{(async()=>{await s.initialize();const u=Object.values(v).flat();await Promise.all(u.map(o=>s.loadAsset(o)))})()},[s]),d.jsx(n.Provider,{value:s,children:i})};export{V as A,M as u};
