import{r as T,j as e,R as J}from"./vendor-react-CGo4xw.js";import{e as le,N as ve,B as Pe,T as Le,A as Ye,S as Ee,a as ce,G as de,C as ue,b as X,c as Ue,F as he,d as H}from"./vendor-pixi-Dyo-us.js";const Fe="modulepreload",ze=function(i,a){return new URL(i,a).href},xe={},Se=function(a,l,n){let c=Promise.resolve();if(l&&l.length>0){let o=function(C){return Promise.all(C.map(u=>Promise.resolve(u).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};const s=document.getElementsByTagName("link"),_=document.querySelector("meta[property=csp-nonce]"),R=_?.nonce||_?.getAttribute("nonce");c=o(l.map(C=>{if(C=ze(C,n),C in xe)return;xe[C]=!0;const u=C.endsWith(".css"),I=u?'[rel="stylesheet"]':"";if(!!n)for(let E=s.length-1;E>=0;E--){const D=s[E];if(D.href===C&&(!u||D.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${C}"]${I}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":Fe,u||(p.as="script"),p.crossOrigin="",p.href=C,R&&p.setAttribute("nonce",R),document.head.appendChild(p),u)return new Promise((E,D)=>{p.addEventListener("load",E),p.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${C}`)))})}))}function h(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return c.then(o=>{for(const s of o||[])s.status==="rejected"&&h(s.reason);return a().catch(h)})};function q(){T.useEffect(()=>{le({Container:ue,Graphics:de,Text:ce,Sprite:Ee,AnimatedSprite:Ye,TilingSprite:Le,BitmapText:Pe,NineSliceSprite:ve})},[])}class Ke{_masterVolume=1;_musicVolume=.7;_sfxVolume=.8;_muted=!1;_currentMusicTrack=null;_fallbackMode=!1;currentMusic=null;soundCache=new Map;_isInitialized=!1;constructor(a){a&&(this._masterVolume=a.masterVolume??1,this._musicVolume=a.musicVolume??.7,this._sfxVolume=a.sfxVolume??.8)}get isInitialized(){return this._isInitialized}get fallbackMode(){return this._fallbackMode}get currentMusicTrack(){return this._currentMusicTrack}get masterVolume(){return this._masterVolume}get sfxVolume(){return this._sfxVolume}get musicVolume(){return this._musicVolume}get muted(){return this._muted}async initialize(a){try{new(window.AudioContext||window.webkitAudioContext),this._isInitialized=!0,this._fallbackMode=!1,a&&(this._masterVolume=a.masterVolume??this._masterVolume,this._musicVolume=a.musicVolume??this._musicVolume,this._sfxVolume=a.sfxVolume??this._sfxVolume)}catch{this._isInitialized=!0,this._fallbackMode=!0}}async loadAsset(a){try{const l=new Audio(a.url);l.volume=a.volume||1,l.preload="auto",this.soundCache.set(a.id,l)}catch{}}async playSoundEffect(a){if(this._muted)return;const l=this.soundCache.get(a);if(l)try{l.currentTime=0,l.volume=this._sfxVolume*this._masterVolume,await l.play()}catch{}}async playSFX(a,l){if(this._muted)return;const n=this.soundCache.get(a);if(n)try{n.currentTime=0,n.volume=(l??this._sfxVolume)*this._masterVolume,await n.play()}catch{}}async playMusic(a,l){if(this._muted)return;this.stopMusic();const n=this.soundCache.get(a);if(n)try{n.currentTime=0,n.volume=(l??this._musicVolume)*this._masterVolume,n.loop=!0,this.currentMusic=n,this._currentMusicTrack=a,await n.play()}catch{}}stopMusic(){this.currentMusic&&(this.currentMusic.pause(),this.currentMusic.currentTime=0,this.currentMusic=null,this._currentMusicTrack=null)}stopAll(){this.stopMusic(),this.soundCache.forEach(a=>{a.paused||(a.pause(),a.currentTime=0)})}setVolume(a,l){const n=Math.max(0,Math.min(1,l));switch(a){case"master":this._masterVolume=n;break;case"sfx":this._sfxVolume=n;break;case"music":this._musicVolume=n,this.currentMusic&&(this.currentMusic.volume=this._musicVolume*this._masterVolume);break}}mute(){this._muted=!0,this.currentMusic&&(this.currentMusic.volume=0)}unmute(){this._muted=!1,this.currentMusic&&(this.currentMusic.volume=this._musicVolume*this._masterVolume)}async fadeOut(a=1e3){if(this.currentMusic)return new Promise(l=>{const c=this.currentMusic.volume/(a/50),h=setInterval(()=>{this.currentMusic&&this.currentMusic.volume>0?this.currentMusic.volume=Math.max(0,this.currentMusic.volume-c):(clearInterval(h),this.stopMusic(),l())},50)})}async fadeIn(a,l=1e3){if(await this.playMusic(a,0),!!this.currentMusic)return new Promise(n=>{const c=this._musicVolume*this._masterVolume,h=c/(l/50),o=setInterval(()=>{this.currentMusic&&this.currentMusic.volume<c?this.currentMusic.volume=Math.min(c,this.currentMusic.volume+h):(clearInterval(o),n())},50)})}async crossfade(a,l,n=1e3){await this.fadeOut(n),await this.fadeIn(l,n)}getLoadedAssets(){return new Map(this.soundCache)}async playVoice(a){return this.playSoundEffect(a)}async playKoreanTechniqueSound(a,l){const n=`${l}_${a}`;return this.playSoundEffect(n)}async playTrigramStanceSound(a){const l=`stance_${a}`;return this.playSoundEffect(l)}async playVitalPointHitSound(a){const l=`vital_point_${a}`;return this.playSoundEffect(l)}async playDojiangAmbience(){return this.playMusic("dojang_ambience")}getMasterVolume(){return this._masterVolume}getMusicVolume(){return this._musicVolume}getSfxVolume(){return this._sfxVolume}get initialized(){return this._isInitialized}}var L=(i=>(i.SFX="sfx",i.MUSIC="music",i.VOICE="voice",i.UI="ui",i))(L||{});const We=[{id:"attack_light",name:"Light Attack",type:"sound",url:"/assets/audio/sfx/attack_light.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:L.SFX,pitch:1},{id:"attack_medium",name:"Medium Attack",type:"sound",url:"/assets/audio/sfx/attack_medium.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:L.SFX,pitch:1},{id:"attack_heavy",name:"Heavy Attack",type:"sound",url:"/assets/audio/sfx/attack_heavy.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:L.SFX,pitch:.8},{id:"stance_change",name:"Stance Change",type:"sound",url:"/assets/audio/sfx/stance_change.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.6,category:L.SFX,pitch:1.2},{id:"block_success",name:"Successful Block",type:"sound",url:"/assets/audio/sfx/block_success.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:L.SFX,pitch:1.1},{id:"vital_hit_critical",name:"Critical Vital Point Hit",type:"sound",url:"/assets/audio/sfx/vital_hit_critical.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:L.SFX,pitch:.8}],Be=[{id:"intro_theme",name:"Black Trigram Theme",type:"music",url:"/assets/audio/music/intro_theme.mp3",formats:["audio/mp3","audio/webm"],loaded:!1,title:{korean:"흑괘 테마",english:"Black Trigram Theme"},volume:.7,loop:!0,category:L.MUSIC,bpm:90},{id:"combat_theme",name:"Combat Music",type:"music",url:"/assets/audio/music/combat_theme.mp3",formats:["audio/mp3","audio/webm"],loaded:!1,title:{korean:"전투 음악",english:"Combat Music"},volume:.8,loop:!0,category:L.MUSIC,bpm:140},{id:"dojang_ambience",name:"Dojang Atmosphere",type:"music",url:"/assets/audio/music/dojang_ambience.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,title:{korean:"도장 분위기",english:"Dojang Atmosphere"},volume:.4,loop:!0,category:"music",bpm:60}],ke=[{id:"musa_theme",name:"Traditional Warrior",type:"music",url:"/assets/audio/music/archetype_themes/musa_warrior.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"무사의 테마",english:"Warrior's Theme"},volume:.8,loop:!0,category:L.MUSIC,bpm:120},{id:"amsalja_theme",name:"Shadow Assassin",type:"music",url:"/assets/audio/music/archetype_themes/amsalja_shadow.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"암살자의 테마",english:"Assassin's Theme"},volume:.7,loop:!0,category:L.MUSIC,bpm:160},{id:"hacker_theme",name:"Cyber Warrior",type:"music",url:"/assets/audio/music/archetype_themes/hacker_cyber.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"해커의 테마",english:"Hacker's Theme"},volume:.8,loop:!0,category:L.MUSIC,bpm:180},{id:"jeongbo_theme",name:"Intelligence Operative",type:"music",url:"/assets/audio/music/archetype_themes/jeongbo_intel.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"정보요원의 테마",english:"Intelligence Theme"},volume:.7,loop:!0,category:L.MUSIC,bpm:100},{id:"jojik_theme",name:"Organized Crime",type:"music",url:"/assets/audio/music/archetype_themes/jojik_street.mp3",formats:["audio/mp3"],loaded:!1,title:{korean:"조직폭력배의 테마",english:"Crime Fighter's Theme"},volume:.8,loop:!0,category:L.MUSIC,bpm:140}],Ne=[{id:"geon_technique",name:"Heaven Technique",type:"sound",url:"/assets/audio/sfx/techniques/geon_heaven.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:L.SFX,pitch:1},{id:"tae_technique",name:"Lake Technique",type:"sound",url:"/assets/audio/sfx/techniques/tae_lake.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:L.SFX,pitch:1.1},{id:"li_technique",name:"Fire Technique",type:"sound",url:"/assets/audio/sfx/techniques/li_fire.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:L.SFX,pitch:1.3},{id:"jin_technique",name:"Thunder Technique",type:"sound",url:"/assets/audio/sfx/techniques/jin_thunder.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.9,category:L.SFX,pitch:.9},{id:"son_technique",name:"Wind Technique",type:"sound",url:"/assets/audio/sfx/techniques/son_wind.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.6,category:L.SFX,pitch:1.4},{id:"gam_technique",name:"Water Technique",type:"sound",url:"/assets/audio/sfx/techniques/gam_water.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.7,category:L.SFX,pitch:.8},{id:"gan_technique",name:"Mountain Technique",type:"sound",url:"/assets/audio/sfx/techniques/gan_mountain.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:L.SFX,pitch:.7},{id:"gon_technique",name:"Earth Technique",type:"sound",url:"/assets/audio/sfx/techniques/gon_earth.mp3",formats:["audio/mp3","audio/wav"],loaded:!1,volume:.8,category:L.SFX,pitch:.6}],He=[...We,...Ne],Xe=[...Be,...ke],$e={soundEffects:He,musicTracks:Xe,techniques:Ne,archetypeThemes:ke},Ie=T.createContext(null),be=()=>{const i=T.useContext(Ie);if(!i)throw new Error("useAudio must be inside AudioProvider");return i},qe=({children:i,config:a,manager:l})=>{const[n]=T.useState(()=>l||new Ke(a));return T.useEffect(()=>{(async()=>{await n.initialize();const c=Object.values($e).flat();await Promise.all(c.map(h=>n.loadAsset(h)))})()},[n]),e.jsx(Ie.Provider,{value:n,children:i})},t={PRIMARY_CYAN:65535,PRIMARY_BLUE_DARK:13209,SECONDARY_MAGENTA:16711935,SECONDARY_YELLOW:16776960,SECONDARY_BROWN_DARK:9127187,ACCENT_GOLD:16766720,ACCENT_RED:16724787,ACCENT_GREEN:65331,ACCENT_PRIMARY:54527,ACCENT_CYAN:65535,ACCENT_BLUE:3381759,KOREAN_RED:13111342,KOREAN_BLUE:13432,KOREAN_WHITE:16777215,KOREAN_BLACK:0,TEXT_PRIMARY:16777215,TEXT_SECONDARY:13421772,TEXT_TERTIARY:10066329,UI_BACKGROUND_DARK:1710638,UI_BACKGROUND_MEDIUM:1450302,UI_BACKGROUND_LIGHT:986915,UI_STEEL_GRAY:4871528,UI_STEEL_GRAY_DARK:2963272,UI_BORDER:4871528,UI_GRAY:8421504,UI_DISABLED_BORDER:1710638,UI_DISABLED_BG:3355443,UI_DISABLED_TEXT:6710886,CRITICAL_HIT:16711680,WARNING_YELLOW:16776960,TRIGRAM_GEON_PRIMARY:16766720,TRIGRAM_TAE_PRIMARY:8900331,TRIGRAM_LI_PRIMARY:16729344,TRIGRAM_JIN_PRIMARY:9662683,TRIGRAM_SON_PRIMARY:3329330,TRIGRAM_GAM_PRIMARY:2003199,TRIGRAM_GAN_PRIMARY:9127187,TRIGRAM_GON_PRIMARY:3100495,POSITIVE_GREEN:65280,POSITIVE_GREEN_DARK:26112,NEGATIVE_RED:16711680,WHITE_SOLID:16777215,BLACK_SOLID:0,TRANSPARENT:0,ARENA_BACKGROUND:1710638,NEON_CYAN:65535,NEON_PURPLE:16711935,NEON_PINK:16716947};var $=(i=>(i.VERSUS="versus",i.TRAINING="training",i.TUTORIAL="tutorial",i.PRACTICE="practice",i.STORY="story",i.ARCADE="arcade",i))($||{}),V=(i=>(i.MUSA="musa",i.AMSALJA="amsalja",i.HACKER="hacker",i.JEONGBO_YOWON="jeongbo_yowon",i.JOJIK_POKRYEOKBAE="jojik_pokryeokbae",i))(V||{}),f=(i=>(i.GEON="geon",i.TAE="tae",i.LI="li",i.JIN="jin",i.SON="son",i.GAM="gam",i.GAN="gan",i.GON="gon",i))(f||{}),U=(i=>(i.STRIKE="strike",i.THRUST="thrust",i.BLOCK="block",i.COUNTER_ATTACK="counter_attack",i.THROW="throw",i.GRAPPLE="grapple",i.PRESSURE_POINT="pressure_point",i.NERVE_STRIKE="nerve_strike",i.PUNCH="punch",i.KICK="kick",i.ELBOW="elbow",i.KNEE="knee",i))(U||{}),W=(i=>(i.BLUNT="blunt",i.PIERCING="piercing",i.SLASHING="slashing",i.PRESSURE="pressure",i.NERVE="nerve",i.JOINT="joint",i.INTERNAL="internal",i.IMPACT="impact",i.CRUSHING="crushing",i.SHARP="sharp",i.ELECTRIC="electric",i.FIRE="fire",i.ICE="ice",i.POISON="poison",i.PSYCHIC="psychic",i.BLOOD="blood",i))(W||{}),ae=(i=>(i.NEUROLOGICAL="neurological",i.VASCULAR="vascular",i.RESPIRATORY="respiratory",i.MUSCULAR="muscular",i.SKELETAL="skeletal",i.ORGAN="organ",i.CIRCULATORY="circulatory",i.LYMPHATIC="lymphatic",i.ENDOCRINE="endocrine",i.JOINT="joint",i.NERVE="nerve",i.PRESSURE="pressure",i))(ae||{}),ne=(i=>(i.MINOR="minor",i.MODERATE="moderate",i.MAJOR="major",i.CRITICAL="critical",i.LETHAL="lethal",i))(ne||{}),re=(i=>(i.UNCONSCIOUSNESS="unconsciousness",i.BREATHLESSNESS="breathlessness",i.PAIN="pain",i.PARALYSIS="paralysis",i.STUN="stun",i.WEAKNESS="weakness",i.DISORIENTATION="disorientation",i.BLOOD_FLOW_RESTRICTION="blood_flow_restriction",i.NERVE_DISRUPTION="nerve_disruption",i.ORGAN_DISRUPTION="organ_disruption",i))(re||{}),se=(i=>(i.WEAK="weak",i.MEDIUM="medium",i.HIGH="high",i.EXTREME="extreme",i))(se||{}),Ve=(i=>(i.IDLE="idle",i.ATTACKING="attacking",i.DEFENDING="defending",i.STUNNED="stunned",i.RECOVERING="recovering",i.COUNTERING="countering",i.TRANSITIONING="transitioning",i))(Ve||{});const me={[V.MUSA]:{id:"musa",name:{korean:"무사",english:"Warrior"},description:{korean:"전통 무사의 길",english:"Path of the traditional warrior"},baseHealth:120,baseKi:100,baseStamina:110,coreStance:f.GEON,theme:{primary:t.TRIGRAM_GEON_PRIMARY,secondary:t.KOREAN_RED},colors:{primary:t.TRIGRAM_GEON_PRIMARY,secondary:t.KOREAN_RED},stats:{attackPower:85,defense:90,speed:70,technique:80},favoredStances:[f.GEON,f.GAN],specialAbilities:["Honor Strike","Defensive Mastery"],philosophy:{korean:"명예와 정의의 길",english:"The way of honor and justice"}},[V.AMSALJA]:{id:"amsalja",name:{korean:"암살자",english:"Assassin"},description:{korean:"그림자 속의 효율성",english:"Efficiency from the shadows"},baseHealth:80,baseKi:120,baseStamina:100,coreStance:f.SON,theme:{primary:t.TRIGRAM_SON_PRIMARY,secondary:t.UI_BACKGROUND_DARK},colors:{primary:t.TRIGRAM_SON_PRIMARY,secondary:t.UI_BACKGROUND_DARK},stats:{attackPower:95,defense:60,speed:95,technique:90},favoredStances:[f.SON,f.GAM],specialAbilities:["Shadow Strike","Vital Point Mastery"],philosophy:{korean:"침묵과 정확성의 도",english:"The way of silence and precision"}},[V.HACKER]:{id:"hacker",name:{korean:"해커",english:"Hacker"},description:{korean:"정보를 통한 힘",english:"Power through information"},baseHealth:90,baseKi:130,baseStamina:80,coreStance:f.LI,theme:{primary:t.PRIMARY_CYAN,secondary:t.TRIGRAM_LI_PRIMARY},colors:{primary:t.PRIMARY_CYAN,secondary:t.TRIGRAM_LI_PRIMARY},stats:{attackPower:75,defense:70,speed:85,technique:95},favoredStances:[f.LI,f.JIN],specialAbilities:["System Override","Digital Precision"],philosophy:{korean:"지식과 기술의 융합",english:"The fusion of knowledge and technology"}},[V.JEONGBO_YOWON]:{id:"jeongbo_yowon",name:{korean:"정보요원",english:"Agent"},description:{korean:"관찰을 통한 지식",english:"Knowledge through observation"},baseHealth:100,baseKi:110,baseStamina:100,coreStance:f.TAE,theme:{primary:t.TRIGRAM_TAE_PRIMARY,secondary:t.UI_STEEL_GRAY},colors:{primary:t.TRIGRAM_TAE_PRIMARY,secondary:t.UI_STEEL_GRAY},stats:{attackPower:80,defense:85,speed:80,technique:85},favoredStances:[f.TAE,f.GAN],specialAbilities:["Intel Gathering","Adaptive Combat"],philosophy:{korean:"적응과 전략의 예술",english:"The art of adaptation and strategy"}},[V.JOJIK_POKRYEOKBAE]:{id:"jojik_pokryeokbae",name:{korean:"조직폭력배",english:"Gangster"},description:{korean:"무자비함을 통한 생존",english:"Survival through ruthlessness"},baseHealth:110,baseKi:90,baseStamina:120,coreStance:f.JIN,theme:{primary:t.TRIGRAM_JIN_PRIMARY,secondary:t.NEGATIVE_RED},colors:{primary:t.TRIGRAM_JIN_PRIMARY,secondary:t.NEGATIVE_RED},stats:{attackPower:90,defense:75,speed:75,technique:70},favoredStances:[f.JIN,f.GON],specialAbilities:["Brutal Force","Street Fighting"],philosophy:{korean:"강함과 의지의 길",english:"The way of strength and will"}}};f.GEON+"",f.GEON,U.STRIKE,W.BLUNT,f.TAE+"",f.TAE,U.STRIKE,W.BLUNT,f.LI+"",f.LI,U.THRUST,W.PIERCING,f.JIN+"",f.JIN,U.STRIKE,W.BLUNT,f.SON+"",f.SON,U.STRIKE,W.BLUNT,f.GAM+"",f.GAM,U.COUNTER_ATTACK,W.BLUNT,f.GAN+"",f.GAN,U.BLOCK,W.BLUNT,f.GON+"",f.GON,U.GRAPPLE,W.BLUNT;U.STRIKE+"",U.THRUST+"",U.BLOCK+"",U.COUNTER_ATTACK+"",U.THROW+"",U.GRAPPLE+"",U.PRESSURE_POINT+"",U.NERVE_STRIKE+"",U.PUNCH+"",U.KICK+"",U.ELBOW+"",U.KNEE+"";const Je={[f.GEON]:{name:{korean:"건",english:"Heaven"},symbol:"☰",element:"metal",nature:"yang",philosophy:{korean:"하늘",english:"Heaven"},combat:{korean:"직접 공격",english:"Direct attack"},theme:{primary:t.TRIGRAM_GEON_PRIMARY,secondary:t.WHITE_SOLID},defensiveBonus:1,kiFlowModifier:1,techniques:{primary:{korean:"천둥벽력",english:"Thunder Strike",damage:15,kiCost:8,staminaCost:12,hitChance:.85,criticalChance:.12,description:{korean:"하늘의 힘으로 적을 타격한다",english:"Strike the enemy with heavenly force"},targetAreas:["torso","head"],effects:["stun"]}}},[f.TAE]:{name:{korean:"태",english:"Lake"},symbol:"☱",element:"metal",nature:"yin",philosophy:{korean:"호수",english:"Lake"},combat:{korean:"유동적 적응",english:"Fluid adaptation"},theme:{primary:t.TRIGRAM_TAE_PRIMARY,secondary:t.UI_STEEL_GRAY},defensiveBonus:1.1,kiFlowModifier:1.2,techniques:{primary:{korean:"유수연타",english:"Flowing Strikes",damage:10,kiCost:5,staminaCost:8,hitChance:.9,criticalChance:.1,description:{korean:"물의 흐름처럼 연속적인 타격",english:"Continuous strikes like flowing water"},targetAreas:["torso","arms"],effects:["knockback"]}}},[f.LI]:{name:{korean:"리",english:"Fire"},symbol:"☲",element:"metal",nature:"yang",philosophy:{korean:"불",english:"Fire"},combat:{korean:"접근 공격",english:"Close attack"},theme:{primary:t.TRIGRAM_LI_PRIMARY,secondary:t.ACCENT_RED},defensiveBonus:.9,kiFlowModifier:1.1,techniques:{primary:{korean:"화염베기",english:"Flame Slash",damage:18,kiCost:9,staminaCost:11,hitChance:.8,criticalChance:.15,description:{korean:"불의 형상을 한 날카로운 베기",english:"A sharp slash in the form of fire"},targetAreas:["torso","legs"],effects:["burn"]}}},[f.JIN]:{name:{korean:"진",english:"Thunder"},symbol:"☳",element:"metal",nature:"yang",philosophy:{korean:"천둥",english:"Thunder"},combat:{korean:"돌진 공격",english:"Charge attack"},theme:{primary:t.TRIGRAM_JIN_PRIMARY,secondary:t.SECONDARY_YELLOW},defensiveBonus:.8,kiFlowModifier:1.3,techniques:{primary:{korean:"천둥의 박치기",english:"Thunder Clap",damage:20,kiCost:10,staminaCost:15,hitChance:.82,criticalChance:.18,description:{korean:"천둥의 힘으로 적을 가격",english:"Strike the enemy with the force of thunder"},targetAreas:["head","torso"],effects:["stun","knockback"]}}},[f.SON]:{name:{korean:"손",english:"Wind"},symbol:"☴",element:"metal",nature:"yin",philosophy:{korean:"바람",english:"Wind"},combat:{korean:"회피 공격",english:"Evasive attack"},theme:{primary:t.TRIGRAM_SON_PRIMARY,secondary:t.POSITIVE_GREEN_DARK},defensiveBonus:1.2,kiFlowModifier:.9,techniques:{primary:{korean:"바람베기",english:"Wind Cut",damage:12,kiCost:6,staminaCost:10,hitChance:.88,criticalChance:.14,description:{korean:"바람의 힘으로 적을 베어내다",english:"Cut through the enemy with the power of wind"},targetAreas:["torso","arms"],effects:["bleed"]}}},[f.GAM]:{name:{korean:"감",english:"Water"},symbol:"☵",element:"metal",nature:"yin",philosophy:{korean:"물",english:"Water"},combat:{korean:"유동 공격",english:"Flowing attack"},theme:{primary:t.TRIGRAM_GAM_PRIMARY,secondary:t.PRIMARY_BLUE_DARK},defensiveBonus:1.3,kiFlowModifier:1.1,techniques:{primary:{korean:"수륙재해",english:"Water Whip",damage:14,kiCost:7,staminaCost:9,hitChance:.84,criticalChance:.13,description:{korean:"물의 힘으로 적을 휘감아 타격",english:"Strike the enemy by wrapping them with the power of water"},targetAreas:["torso","legs"],effects:["drown"]}}},[f.GAN]:{name:{korean:"간",english:"Mountain"},symbol:"☶",element:"metal",nature:"yin",philosophy:{korean:"산",english:"Mountain"},combat:{korean:"방어 자세",english:"Defensive stance"},theme:{primary:t.TRIGRAM_GAN_PRIMARY,secondary:t.UI_STEEL_GRAY_DARK},defensiveBonus:1.4,kiFlowModifier:.8,techniques:{primary:{korean:"산의 수호",english:"Mountain Guard",damage:0,kiCost:10,staminaCost:15,hitChance:1,criticalChance:0,description:{korean:"산처럼 견고한 방어 자세",english:"A defensive stance as solid as a mountain"},targetAreas:["torso"],effects:["block"]}}},[f.GON]:{name:{korean:"곤",english:"Earth"},symbol:"☷",element:"metal",nature:"yang",philosophy:{korean:"지구",english:"Earth"},combat:{korean:"포용 공격",english:"Embracing attack"},theme:{primary:t.TRIGRAM_GON_PRIMARY,secondary:t.SECONDARY_BROWN_DARK},defensiveBonus:1.1,kiFlowModifier:1.2,techniques:{primary:{korean:"지구의 방패",english:"Earth Shield",damage:0,kiCost:12,staminaCost:16,hitChance:1,criticalChance:0,description:{korean:"지구의 힘으로 적의 공격을 막다",english:"Block the enemy's attack with the power of earth"},targetAreas:["torso"],effects:["block"]}}}};f.GEON+"",f.GON+"",f.SON+"",f.TAE+"",f.JIN+"",f.GAN+"",f.LI+"",f.GAM+"",f.TAE+"",f.JIN+"",f.SON+"",f.GEON+"",f.SON+"",f.GON+"",f.LI+"",f.GAM+"",f.LI+"",f.JIN+"",f.GAN+"",f.TAE+"",f.GAM+"",f.GON+"",f.GEON+"",f.SON+"",f.GAM+"";const Me={KOREAN_BATTLE:'"Noto Sans KR", Impact, sans-serif',KOREAN:'"Noto Sans KR", "Malgun Gothic", Arial, sans-serif'},Q={medium:16,large:20,title:36},Ze={medium:16},te={normal:"normal",bold:"bold"},ee={fontFamily:Me.KOREAN,fontSize:Ze.medium,fill:t.TEXT_PRIMARY,align:"left",wordWrap:!1,fontWeight:te.normal,dropShadow:{alpha:.5,angle:Math.PI/6,blur:2,color:0,distance:2}};new X(ee),new X({...ee,fontFamily:Me.KOREAN_BATTLE,fontSize:Q.title,fontWeight:te.bold,fill:t.ACCENT_PRIMARY,align:"center",dropShadow:{alpha:.8,angle:Math.PI/6,blur:3,color:0,distance:3}}),new X({...ee,fontSize:Q.large,fontWeight:te.normal,fill:t.TEXT_SECONDARY,align:"center"}),new X({...ee,fontSize:Q.medium,lineHeight:Q.medium*1.5}),new X({...ee,fontSize:Q.medium,fontWeight:te.bold,fill:t.TEXT_PRIMARY,align:"center"});const pe={stanceControls:{1:{stance:"geon",korean:"건",technique:"천둥벽력"},2:{stance:"tae",korean:"태",technique:"유수연타"},3:{stance:"li",korean:"리",technique:"화염지창"},4:{stance:"jin",korean:"진",technique:"벽력일섬"},5:{stance:"son",korean:"손",technique:"선풍연격"},6:{stance:"gam",korean:"감",technique:"수류반격"},7:{stance:"gan",korean:"간",technique:"반석방어"},8:{stance:"gon",korean:"곤",technique:"대지포옹"}},combat:{SPACE:"Execute current stance technique",SHIFT:"Defensive guard/block position",CTRL:"Precision vital point targeting mode",TAB:"Cycle through player archetypes"}},fe=[{id:"baekhoehoel",korean:{korean:"백회혈",english:"Crown Point",romanized:"baekhoehoel"},english:"Crown Point",anatomicalName:"Anterior Fontanelle",category:ae.NEUROLOGICAL,severity:ne.CRITICAL,position:{x:0,y:-50},radius:15,effects:[{id:"unconsciousness_effect",type:re.UNCONSCIOUSNESS,intensity:se.HIGH,duration:5e3,description:{korean:"의식 잃음",english:"Loss of consciousness"},stackable:!1}],damage:{min:40,max:60,average:50},description:{korean:"머리 정수리의 중요 혈점",english:"Critical pressure point at crown of head"},difficulty:.9,requiredForce:30,safetyWarning:"Extremely dangerous - can cause death"},{id:"inmyeong",korean:{korean:"인명",english:"People's Life",romanized:"inmyeong"},english:"People's Life",anatomicalName:"Philtrum",category:ae.NEUROLOGICAL,severity:ne.MODERATE,position:{x:0,y:-10},radius:8,effects:[{id:"stun_effect",type:re.STUN,intensity:se.MEDIUM,duration:2e3,description:{korean:"일시적 기절",english:"Temporary stunning"},stackable:!1}],damage:{min:15,max:25,average:20},description:{korean:"인중의 신경 집중 부위",english:"Nerve concentration area of philtrum"},difficulty:.6,requiredForce:15,safetyWarning:"Can cause temporary unconsciousness"}];fe.filter(i=>i.position.y<0),fe.filter(i=>i.position.y>=50&&i.position.y<=200);const ye=({selectedMode:i,onModeSelect:a,onStartGame:l,onShowPhilosophy:n,onShowControls:c,width:h,height:o,x:s,y:_,menuItems:R})=>{const C=T.useCallback(()=>{},[]);return e.jsxs("pixiContainer",{x:s,y:_,"data-testid":"menu-section",children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.beginFill(t.UI_BACKGROUND_DARK,.9),u.drawRoundedRect(0,0,h,o,8),u.endFill(),u.setStrokeStyle({width:2,color:t.PRIMARY_CYAN,alpha:.7}),u.drawRoundedRect(0,0,h,o,8)}}),e.jsxs("pixiContainer",{x:20,y:20,"data-testid":"action-buttons",children:[R.map((u,I)=>{const x=u.mode==="training",p=u.mode==="versus";return e.jsxs("pixiContainer",{y:I*60,"data-testid":x?"training-button":p?"combat-button":`${u.mode.toLowerCase()}-button`,children:[e.jsx("pixiGraphics",{draw:E=>{E.clear(),E.beginFill(i===u.mode?t.ACCENT_GOLD:t.UI_BACKGROUND_MEDIUM,.8),E.drawRoundedRect(0,0,h-40,50,5),E.endFill()},interactive:!0,onPointerDown:()=>a(u.mode)}),e.jsx("pixiText",{text:`${u.korean} - ${u.english}`,style:{fontSize:16,fill:t.TEXT_PRIMARY,align:"center"},x:(h-40)/2,y:25,anchor:.5})]},u.mode)}),e.jsxs("pixiContainer",{y:R.length*60+20,"data-testid":"start-game-button",children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.beginFill(t.POSITIVE_GREEN,.8),u.drawRoundedRect(0,0,h-40,50,5),u.endFill()},interactive:!0,onPointerDown:l}),e.jsx("pixiText",{text:"게임 시작 - Start Game",style:{fontSize:16,fill:t.TEXT_PRIMARY,align:"center"},x:(h-40)/2,y:25,anchor:.5})]})]}),e.jsxs("pixiContainer",{x:20,y:o-80,"data-testid":"archetype-section",children:[e.jsxs("pixiContainer",{"data-testid":"archetype-toggle",children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.beginFill(t.UI_BACKGROUND_MEDIUM,.6),u.drawRoundedRect(0,0,h-40,30,3),u.endFill()},interactive:!0,onPointerDown:C}),e.jsx("pixiText",{text:"무사 선택 - Select Archetype ▼",style:{fontSize:12,fill:t.TEXT_SECONDARY,align:"center"},x:(h-40)/2,y:15,anchor:.5})]}),e.jsx("pixiContainer",{y:35,"data-testid":"archetype-list",alpha:0,children:["musa","amsalja","hacker","jeongbo_yowon","jojik_pokryeokbae"].map((u,I)=>e.jsxs("pixiContainer",{y:I*25,"data-testid":`archetype-option-${u}`,children:[e.jsx("pixiGraphics",{draw:x=>{x.clear(),x.beginFill(t.UI_BACKGROUND_LIGHT,.8),x.drawRoundedRect(0,0,h-40,20,2),x.endFill()}}),e.jsx("pixiText",{text:u,style:{fontSize:10,fill:t.TEXT_SECONDARY},x:5,y:10,anchor:{x:0,y:.5}})]},u))}),e.jsx("pixiContainer",{y:-30,"data-testid":"selected-archetype",children:e.jsx("pixiText",{text:"선택된 무사: 무사",style:{fontSize:10,fill:t.ACCENT_GOLD}})})]}),e.jsxs("pixiContainer",{x:20,y:o-100,"data-testid":"philosophy-button",children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.beginFill(t.UI_BACKGROUND_MEDIUM,.6),u.drawRoundedRect(0,0,100,35,5),u.endFill()},interactive:!0,onPointerDown:n}),e.jsx("pixiText",{text:"철학 - Philosophy",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:50,y:17.5,anchor:.5})]}),e.jsxs("pixiContainer",{x:130,y:o-100,"data-testid":"controls-button",children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.beginFill(t.UI_BACKGROUND_MEDIUM,.6),u.drawRoundedRect(0,0,100,35,5),u.endFill()},interactive:!0,onPointerDown:c}),e.jsx("pixiText",{text:"조작 - Controls",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:50,y:17.5,anchor:.5})]})]})},Qe=({title:i,subtitle:a,size:l="medium",alignment:n="center",x:c=0,y:h=0,width:o=400,height:s=80})=>{q();const R={small:{titleSize:18,subtitleSize:12,spacing:25},medium:{titleSize:24,subtitleSize:16,spacing:35},large:{titleSize:32,subtitleSize:20,spacing:45}}[l],C=n==="center"?.5:n==="right"?1:0,u=n==="center"?o/2:n==="right"?o:0;return e.jsxs("pixiContainer",{x:c,y:h,"data-testid":"korean-header",children:[e.jsx("pixiText",{text:i.korean,style:{fontSize:R.titleSize,fill:t.ACCENT_GOLD,fontWeight:"bold",align:n},x:u,y:0,anchor:{x:C,y:0}}),e.jsx("pixiText",{text:i.english,style:{fontSize:R.titleSize*.8,fill:t.TEXT_SECONDARY,align:n},x:u,y:R.titleSize+5,anchor:{x:C,y:0}}),a&&e.jsxs(e.Fragment,{children:[e.jsx("pixiText",{text:a.korean,style:{fontSize:R.subtitleSize,fill:t.TEXT_PRIMARY,align:n},x:u,y:R.spacing+10,anchor:{x:C,y:0}}),e.jsx("pixiText",{text:a.english,style:{fontSize:R.subtitleSize*.9,fill:t.TEXT_TERTIARY,align:n},x:u,y:R.spacing+10+R.subtitleSize+3,anchor:{x:C,y:0}})]}),e.jsx("pixiGraphics",{draw:I=>{I.clear(),I.lineStyle(2,t.ACCENT_GOLD,.7);const x=s-10,p=o*.6,E=n==="center"?(o-p)/2:0;I.moveTo(E,x),I.lineTo(E+p,x)}})]})},et=T.lazy(()=>Se(()=>Promise.resolve().then(()=>ut),void 0,import.meta.url)),tt=T.lazy(()=>Se(()=>Promise.resolve().then(()=>ht),void 0,import.meta.url));function it(){const[i,a]=T.useState({width:window.innerWidth,height:window.innerHeight});return T.useEffect(()=>{const l=()=>a({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),i}const K=[{mode:$.VERSUS,korean:"대전",english:"Versus"},{mode:$.TRAINING,korean:"훈련",english:"Training"},{mode:$.PRACTICE,korean:"연습",english:"Practice"}],ft=({onMenuSelect:i,width:a,height:l})=>{const n=be(),c=T.useRef(!1),[h,o]=T.useState("menu"),[s,_]=T.useState(null),[R,C]=T.useState(null),[u,I]=T.useState(null),[x,p]=T.useState({overview:null,explained:null,dynamics:null}),[E,D]=T.useState(0),[b,m]=T.useState(0),{width:y,height:N}=it(),S=a??y,M=l??N;T.useEffect(()=>{let d=!1;_(Ue.from("/assets/visual/bg/intro/intro_bg_loop_low.webp"));const j=async()=>{try{const O=window?.navigator?.userAgent.includes("Safari")?"/assets/visual/bg/intro/intro_bg_loop.png":"/assets/visual/bg/intro/intro_bg_loop.webp",[w,Z,Ge,ge,De,we]=await Promise.all([H.load(O),H.load("/src/assets/visual/logo/black-trigram.png"),H.load("/src/assets/dojang_wall_neon_flicker.png"),H.load("/src/assets/visual/bg/archetyples/PlayerArchetypesOverview.png"),H.load("/src/assets/visual/bg/archetyples/PlayerArchetypesExplained.png"),H.load("/src/assets/visual/bg/archetyples/CyberpunkTeamDynamics.png")]);if(d)return;_(w),C(Z),I(Ge),p({overview:ge,explained:De,dynamics:we})}catch{}};return"requestIdleCallback"in window?window.requestIdleCallback(j):setTimeout(j,100),()=>{d=!0}},[]),T.useEffect(()=>{const d=()=>{n.isInitialized&&!c.current&&(c.current=!0,n.playMusic("intro_theme")),window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)};return window.addEventListener("keydown",d,{once:!0}),window.addEventListener("mousedown",d,{once:!0}),window.addEventListener("touchstart",d,{once:!0}),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d),n.stopMusic()}},[n.isInitialized,n]),T.useEffect(()=>{const d=j=>{if(h!=="menu"&&j.key==="Escape"){o("menu"),n.playSFX("menu_back");return}if(h==="menu")if(j.key==="ArrowUp")m(O=>{const w=O===0?K.length-1:O-1;return n.playSFX("menu_hover"),w});else if(j.key==="ArrowDown")m(O=>{const w=O===K.length-1?0:O+1;return n.playSFX("menu_hover"),w});else if(j.key===" "||j.key==="Enter")n.playSFX("menu_select"),i(K[b].mode);else switch(j.key){case"1":m(0),n.playSFX("menu_hover"),n.playSFX("menu_select"),i($.VERSUS);break;case"2":m(1),n.playSFX("menu_hover"),n.playSFX("menu_select"),i($.TRAINING);break;case"3":m(2),n.playSFX("menu_hover"),n.playSFX("menu_select"),i($.PRACTICE);break;case"F1":o("controls"),n.playSFX("menu_select");break;case"4":o("philosophy"),n.playSFX("menu_select");break}};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[i,h,n,b]);const A=T.useCallback(d=>{const j=K.findIndex(O=>O.mode===d);m(j>=0?j:0),n.playSFX("menu_select"),i(d)},[i,n]),g=T.useCallback(()=>{o("philosophy"),n.playSFX("menu_select")},[n]),v=T.useCallback(()=>{o("controls"),n.playSFX("menu_select")},[n]),Y=T.useCallback(()=>{o("menu"),n.playSFX("menu_back")},[n]),r=S<768,G=S>=768&&S<1024,k=r?Math.min(S,M)*.35:G?Math.min(S,M)*.25:Math.min(S,M)*.2,P=M*(r?.65:G?.6:.55),ie=T.useCallback(d=>{d.clear();const j=new he(0,0,S,M);j.addColorStop(0,657935),j.addColorStop(.5,1710638),j.addColorStop(1,986915),d.fill(j),d.rect(0,0,S,M),d.fill(),d.stroke({width:1,color:t.PRIMARY_CYAN,alpha:.15});const O=r?30:40;for(let w=0;w<S;w+=O)d.moveTo(w,0),d.lineTo(w,M);for(let w=0;w<M;w+=O)d.moveTo(0,w),d.lineTo(S,w);d.stroke(),d.stroke({width:2,color:t.ACCENT_GOLD,alpha:.3}),d.moveTo(0,M*.2),d.lineTo(S,M*.2),d.moveTo(0,M*.8),d.lineTo(S,M*.8),d.stroke()},[S,M,r]);return e.jsxs("pixiContainer",{width:S,height:M,"data-testid":"intro-screen",children:[e.jsx("pixiGraphics",{draw:ie,"data-testid":"intro-background"}),s&&e.jsx("pixiSprite",{texture:s,x:0,y:0,width:S,height:M,alpha:.4,"data-testid":"intro-bg-texture"}),h==="menu"&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{selectedMode:K[b].mode,onModeSelect:A,onStartGame:()=>A(K[b].mode),onShowPhilosophy:g,onShowControls:v,width:r?S*.9:G?S*.7:480,height:r?M*.25:M*.3,x:S/2-(r?S*.45:G?S*.35:240),y:P,menuItems:K,"data-testid":"main-menu-section"}),e.jsx("pixiContainer",{x:S/2,y:M*.6,"data-testid":"interactive-menu",children:K.map((d,j)=>e.jsxs("pixiContainer",{y:j*(r?50:60),"data-testid":`menu-item-${d.mode}`,children:[e.jsx("pixiGraphics",{draw:O=>{O.clear();const w=b===j;O.fill({color:w?t.ACCENT_GOLD:t.UI_BACKGROUND_MEDIUM,alpha:.9}),O.roundRect(-(r?120:150),-20,r?240:300,40,8),O.fill(),O.stroke({width:2,color:w?t.PRIMARY_CYAN:t.ACCENT_GOLD,alpha:.8}),O.roundRect(-(r?120:150),-20,r?240:300,40,8),O.stroke()},interactive:!0,onPointerDown:()=>A(d.mode),"data-testid":`menu-button-${d.mode}`}),e.jsx("pixiText",{text:`${d.korean} - ${d.english}`,style:{fontSize:r?14:18,fill:b===j?t.BLACK_SOLID:t.TEXT_PRIMARY,align:"center",fontWeight:b===j?"bold":"normal"},anchor:.5,"data-testid":`menu-text-${d.mode}`})]},d.mode))})]}),u&&e.jsx("pixiSprite",{texture:u,x:S*.8,y:0,width:S*.3,height:M,alpha:.2,"data-testid":"dojang-wall-accent"}),e.jsxs("pixiContainer",{x:S/2,y:M*(r?.25:.3),"data-testid":"logo-section",children:[R&&e.jsx("pixiSprite",{texture:R,x:0,y:0,scale:{x:k/512,y:k/512},anchor:{x:.5,y:.5},alpha:1,"data-testid":"main-logo"}),e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.circle(0,0,k*.6),d.fill({color:t.PRIMARY_CYAN,alpha:.1}),d.circle(0,0,k*.8),d.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6})},"data-testid":"logo-glow-effect"}),e.jsx("pixiContainer",{y:k*.7,"data-testid":"trigram-symbols",children:e.jsx("pixiText",{text:"☰ ☱ ☲ ☳ ☴ ☵ ☶ ☷",style:{fontSize:r?20:28,fill:t.PRIMARY_CYAN,align:"center",letterSpacing:r?8:12},anchor:.5,"data-testid":"trigram-symbols-text"})})]}),e.jsx(Qe,{title:{korean:"흑괘",english:"Black Trigram"},subtitle:{korean:"한국 무술 시뮬레이터",english:"Korean Martial Arts Simulator"},align:"center",x:S/2,y:M*(r?.45:.48),"data-testid":"main-title"}),h==="menu"&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{selectedMode:K[b].mode,onModeSelect:A,onStartGame:()=>A(K[b].mode),onShowPhilosophy:g,onShowControls:v,width:r?S*.9:G?S*.7:480,height:r?M*.25:M*.3,x:S/2-(r?S*.45:G?S*.35:240),y:P,menuItems:K,"data-testid":"main-menu-section"}),e.jsxs("pixiContainer",{x:r?20:40,y:M-(r?220:250),"data-testid":"archetype-selection",children:[e.jsxs("pixiContainer",{"data-testid":"archetype-toggle",children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.fill({color:t.UI_BACKGROUND_MEDIUM,alpha:.9}),d.roundRect(0,0,r?140:180,45,8),d.fill(),d.stroke({width:2,color:t.ACCENT_GOLD,alpha:.8}),d.roundRect(0,0,r?140:180,45,8),d.stroke()},interactive:!0,onPointerDown:()=>{n.playSFX("menu_hover"),D(d=>(d+1)%5)},"data-testid":"archetype-toggle-button"}),e.jsx("pixiText",{text:"무사 유형 선택",style:{fontSize:r?12:14,fill:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:(r?140:180)/2,y:22,anchor:.5,"data-testid":"archetype-toggle-text"})]}),e.jsx("pixiContainer",{y:55,"data-testid":"archetype-list",children:[{id:"musa",korean:"무사",english:"Warrior",color:t.TRIGRAM_GEON_PRIMARY},{id:"amsalja",korean:"암살자",english:"Assassin",color:t.TRIGRAM_SON_PRIMARY},{id:"hacker",korean:"해커",english:"Hacker",color:t.PRIMARY_CYAN},{id:"jeongbo_yowon",korean:"정보요원",english:"Agent",color:t.TRIGRAM_TAE_PRIMARY},{id:"jojik_pokryeokbae",korean:"조직폭력배",english:"Gangster",color:t.TRIGRAM_JIN_PRIMARY}].map((d,j)=>e.jsxs("pixiContainer",{y:j*(r?32:38),"data-testid":`archetype-option-${d.id}`,children:[e.jsx("pixiGraphics",{draw:O=>{O.clear(),O.fill({color:E===j?t.ACCENT_GOLD:t.UI_BACKGROUND_LIGHT,alpha:.8}),O.roundRect(0,0,r?160:200,r?28:32,4),O.fill(),O.stroke({width:1,color:d.color,alpha:.8}),O.roundRect(0,0,r?160:200,r?28:32,4),O.stroke()},interactive:!0,onPointerDown:()=>{D(j),n.playSFX("menu_select")},"data-testid":`archetype-option-${d.id}-button`}),e.jsx("pixiGraphics",{draw:O=>{O.clear(),O.fill({color:d.color,alpha:.8}),O.circle(12,(r?28:32)/2,6),O.fill()},"data-testid":`archetype-icon-${d.id}`}),e.jsx("pixiText",{text:`${d.korean} - ${d.english}`,style:{fontSize:r?10:12,fill:E===j?t.BLACK_SOLID:t.TEXT_PRIMARY,fontWeight:E===j?"bold":"normal"},x:25,y:(r?28:32)/2,anchor:{x:0,y:.5},"data-testid":`archetype-text-${d.id}`})]},d.id))}),e.jsxs("pixiContainer",{y:r?180:210,"data-testid":"selected-archetype",children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.fill({color:t.ACCENT_GOLD,alpha:.2}),d.roundRect(0,0,r?160:200,40,6),d.fill()}}),e.jsx("pixiText",{text:"선택된 무사 유형",style:{fontSize:r?10:12,fill:t.TEXT_SECONDARY},x:8,y:8,"data-testid":"selected-archetype-label"}),e.jsx("pixiText",{text:["무사","암살자","해커","정보요원","조직폭력배"][E],style:{fontSize:r?12:14,fill:t.ACCENT_GOLD,fontWeight:"bold"},x:8,y:22,"data-testid":"selected-archetype-value"})]})]}),e.jsx("pixiContainer",{x:S-(r?S*.95:G?350:400),y:M/2-(r?100:150),"data-testid":"archetype-display",children:!r&&e.jsxs(e.Fragment,{children:[e.jsx("pixiText",{text:"무사 유형 가이드",style:{fontSize:G?16:18,fill:t.ACCENT_GOLD,fontWeight:"bold"},y:-35,"data-testid":"archetype-display-title"}),Object.values(x).filter(Boolean).length>0&&e.jsx("pixiSprite",{texture:Object.values(x).filter(Boolean)[E%Object.values(x).filter(Boolean).length],width:G?280:320,height:G?200:240,interactive:!0,onPointerDown:()=>{D(d=>(d+1)%5),n.playSFX("menu_hover")},"data-testid":"archetype-display-image"}),e.jsx("pixiText",{text:`${E+1} / 5`,style:{fontSize:14,fill:t.TEXT_SECONDARY,align:"center"},x:(G?280:320)/2,y:G?220:260,anchor:.5,"data-testid":"archetype-display-counter"})]})})]}),h==="philosophy"&&e.jsx(T.Suspense,{fallback:e.jsx("pixiText",{text:"로딩 중..."}),children:e.jsx(et,{onBack:Y,width:S*.9,height:M*.8,x:S*.05,y:M*.1,"data-testid":"philosophy-section"})}),h==="controls"&&e.jsx(T.Suspense,{fallback:e.jsx("pixiText",{text:"로딩 중..."}),children:e.jsx(tt,{onBack:Y,width:S*.9,height:M*.8,x:S*.05,y:M*.1,"data-testid":"controls-section"})}),e.jsxs("pixiContainer",{x:S/2,y:M-(r?60:80),"data-testid":"intro-footer",children:[e.jsx("pixiText",{text:"흑괘의 길을 걸어라 - Walk the Path of the Black Trigram",style:{fontSize:r?10:14,fill:t.ACCENT_CYAN,align:"center",fontStyle:"italic"},x:0,y:r?-30:-35,anchor:.5,"data-testid":"footer-motto"}),e.jsx("pixiText",{text:"Open Source Korean Martial Arts Game by Hack23",style:{fontSize:r?9:12,fill:t.SECONDARY_MAGENTA,align:"center",fontWeight:"bold"},interactive:!0,onPointerTap:()=>window.open("https://github.com/Hack23/blacktrigram","_blank"),x:0,y:r?-15:-18,anchor:.5,"data-testid":"footer-link"})]})]})},at=({player:i,x:a,y:l,onClick:n})=>(q(),e.jsxs("pixiContainer",{x:a,y:l,"data-testid":"player",children:[e.jsx("pixiGraphics",{draw:c=>{c.clear(),c.fill({color:t.PRIMARY_CYAN,alpha:.8}),c.rect(-30,-60,60,120),c.fill()},interactive:!0,onPointerDown:n}),e.jsx("pixiText",{text:i.name.korean,style:{fontSize:14,fill:t.TEXT_PRIMARY,align:"center"},x:0,y:-80,anchor:.5,children:i.name.korean}),e.jsx("pixiGraphics",{draw:c=>{c.clear();const h=i.health/i.maxHealth;c.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),c.rect(-25,70,50,8),c.fill(),c.fill({color:t.POSITIVE_GREEN,alpha:.9}),c.rect(-25,70,50*h,8),c.fill()}})]})),nt=({players:i,onPlayerClick:a,width:l=1200,height:n=800,x:c=0,y:h=0})=>(q(),e.jsxs("pixiContainer",{x:c,y:h,children:[e.jsx("pixiGraphics",{draw:o=>{o.clear(),o.beginFill(t.ARENA_BACKGROUND,.3),o.drawRect(0,0,l,n),o.endFill(),o.lineStyle(2,t.UI_BORDER,.5),o.moveTo(l/2,0),o.lineTo(l/2,n)}}),i.map((o,s)=>e.jsx(at,{player:o,x:s===0?l*.25:l*.75,y:n*.7,onClick:()=>a?.(s)},o.id)),e.jsx("pixiGraphics",{draw:o=>{o.clear(),o.lineStyle(3,t.ACCENT_GOLD,.8),o.drawRect(50,100,l-100,n-200)}}),[[75,125],[l-75,125],[75,n-125],[l-75,n-125]].map(([o,s],_)=>e.jsx("pixiGraphics",{draw:R=>{R.clear(),R.beginFill(t.ACCENT_GOLD,.6),R.drawCircle(o,s,8),R.endFill()}},_))]})),rt=({onAttack:i,onDefend:a,onSwitchStance:l,player:n,onTechniqueExecute:c,isExecutingTechnique:h=!1,width:o=300,height:s=100,x:_=0,y:R=0})=>{q();const C=n?Je[n.currentStance]:void 0,u=T.useMemo(()=>{if(!C?.techniques?.primary)return[];const p=C.techniques.primary;return[{id:`${n.currentStance}_primary`,name:{korean:p.korean,english:p.english,romanized:p.korean},koreanName:p.korean,englishName:p.english,romanized:p.korean,description:p.description,stance:n.currentStance,type:"strike",damageType:W.BLUNT,damage:p.damage,damageRange:{min:p.damage-5,max:p.damage+5},range:1,kiCost:p.kiCost,staminaCost:p.staminaCost,accuracy:p.hitChance,executionTime:500,recoveryTime:800,critChance:p.criticalChance,critMultiplier:1.5,effects:[]}]},[C,n.currentStance]),I=T.useCallback(p=>{c?.(p)},[c]),x=T.useCallback(p=>{p.clear(),p.beginFill(t.UI_BACKGROUND_DARK,.9),p.lineStyle(2,t.PRIMARY_CYAN,.8),p.drawRoundedRect(0,0,o,s,10),p.endFill()},[o,s]);return e.jsxs("pixiContainer",{x:_,y:R,"data-testid":"combat-controls",children:[e.jsx("pixiGraphics",{draw:x}),e.jsxs("pixiContainer",{x:10,y:10,children:[e.jsx("pixiGraphics",{draw:p=>{p.clear(),p.beginFill(t.ACCENT_RED,.8),p.drawRoundedRect(0,0,60,30,5),p.endFill()},interactive:!0,onPointerDown:i}),e.jsx("pixiText",{text:"공격",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:30,y:15,anchor:.5})]}),e.jsxs("pixiContainer",{x:80,y:10,children:[e.jsx("pixiGraphics",{draw:p=>{p.clear(),p.beginFill(t.ACCENT_BLUE,.8),p.drawRoundedRect(0,0,60,30,5),p.endFill()},interactive:!0,onPointerDown:a}),e.jsx("pixiText",{text:"방어",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:30,y:15,anchor:.5})]}),u.length>0&&e.jsxs("pixiContainer",{x:150,y:10,children:[e.jsx("pixiGraphics",{draw:p=>{p.clear(),p.beginFill(t.ACCENT_GOLD,.8),p.drawRoundedRect(0,0,80,30,5),p.endFill()},interactive:!0,onPointerDown:()=>I(u[0])}),e.jsx("pixiText",{text:u[0].name.korean,style:{fontSize:10,fill:t.BLACK_SOLID,align:"center"},x:40,y:15,anchor:.5})]}),e.jsx("pixiContainer",{x:10,y:50,children:e.jsx("pixiText",{text:`현재 자세: ${C?.name.korean||"없음"}`,style:{fontSize:10,fill:t.TEXT_SECONDARY}})}),l&&e.jsxs("pixiContainer",{x:150,y:50,children:[e.jsx("pixiGraphics",{draw:p=>{p.clear(),p.beginFill(t.ACCENT_CYAN,.8),p.drawRoundedRect(0,0,80,20,3),p.endFill()},interactive:!0,onPointerDown:()=>l(n.currentStance)}),e.jsx("pixiText",{text:"자세 변경",style:{fontSize:8,fill:t.BLACK_SOLID,align:"center"},x:40,y:10,anchor:.5})]}),h&&e.jsx("pixiContainer",{x:o/2,y:s/2,children:e.jsx("pixiText",{text:"기술 실행 중...",style:{fontSize:12,fill:t.WARNING_YELLOW,align:"center"},anchor:.5})})]})},z=({x:i=0,y:a=0,text:l,width:n,height:c,variant:h="primary",onClick:o,disabled:s=!1,testId:_,"data-testid":R,screenWidth:C=0,screenHeight:u=0})=>{const I=C,x=R??_,[p,E]=T.useState(!1),D=T.useMemo(()=>{const m=I<768,y=I>=768&&I<1024;return m?12:y?14:16},[I]),b=T.useCallback(()=>{if(s)return t.UI_DISABLED_BG;switch(h){case"primary":return t.PRIMARY_CYAN;case"secondary":return t.UI_STEEL_GRAY;case"accent":return t.ACCENT_GOLD;case"ghost":return t.TRANSPARENT;case"danger":return t.NEGATIVE_RED;default:return t.PRIMARY_CYAN}},[h,s]);return e.jsxs("pixiContainer",{x:i,y:a,"data-testid":x,onClick:o,children:[e.jsx("pixiGraphics",{draw:m=>{m.clear();const y=b(),N=p?.8:.6;m.fill({color:y,alpha:N}),m.roundRect(0,0,n||120,c||40,8),m.fill(),m.stroke({width:2,color:s?t.UI_DISABLED_BORDER:t.ACCENT_GOLD,alpha:.8}),m.roundRect(0,0,n||120,c||40,8),m.stroke()},interactive:!s,onPointerOver:()=>!s&&E(!0),onPointerOut:()=>E(!1),onPointerDown:()=>!s&&o?.()}),e.jsx("pixiText",{text:l,style:{fontSize:D,fill:s?t.UI_DISABLED_TEXT:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:(n||120)/2,y:(c||40)/2,anchor:.5,"data-testid":`${x}-text`})]})},F=({x:i=0,y:a=0,children:l,testId:n,"data-testid":c,screenWidth:h,screenHeight:o})=>{const s=c??n;return e.jsx("pixiContainer",{x:i,y:a,"data-testid":s,children:l})},B=({x:i=0,y:a=0,title:l,children:n,width:c=200,height:h=150,testId:o,"data-testid":s,screenWidth:_,screenHeight:R})=>{const C=s??o;return e.jsxs("pixiContainer",{x:i,y:a,"data-testid":C,children:[e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.fill({color:t.UI_BACKGROUND_MEDIUM,alpha:.9}),u.roundRect(0,0,c,h,8),u.fill(),u.stroke({width:2,color:t.ACCENT_GOLD,alpha:.8}),u.roundRect(0,0,c,h,8),u.stroke()}}),l&&e.jsx("pixiText",{text:l,"data-testid":`${C}-title`,style:{fontSize:14,fill:t.ACCENT_GOLD,fontWeight:"bold"},x:10,y:-20}),e.jsx("pixiContainer",{x:0,y:25,children:n})]})},_e=({current:i,max:a,playerName:l,position:n="left",x:c,y:h,width:o,height:s,screenWidth:_,screenHeight:R,showText:C=!0,animated:u=!0,showDamageIndicator:I=!0})=>{const x=_<768,{healthPercentage:p,healthStatus:E,displayHealth:D}=T.useMemo(()=>{const A=a>0?i/a:0;let g="high";return A<=.15?g="critical":A<=.35?g="low":A<=.65&&(g="medium"),{healthPercentage:Math.max(0,Math.min(1,A)),healthStatus:g,displayHealth:Math.max(0,i)}},[i,a]),b=()=>{switch(E){case"critical":return t.ACCENT_RED;case"low":return t.ACCENT_GOLD;case"medium":return t.ACCENT_CYAN;default:return t.ACCENT_GREEN}},m=()=>p>.5?[t.ACCENT_GREEN,t.ACCENT_CYAN]:p>.25?[t.ACCENT_GOLD,t.ACCENT_GREEN]:[t.ACCENT_RED,t.ACCENT_GOLD],y=n==="right",N=n==="center",S=u?Math.sin(Date.now()*.005)*.1+.9:1,M=I&&E==="critical"?Math.sin(Date.now()*.01)*.3+.7:1;return e.jsxs(F,{x:c,y:h,screenWidth:_,screenHeight:R,"data-testid":`health-bar-${n}`,children:[C&&e.jsx("pixiText",{text:l,style:{fontSize:x?12:14,fill:t.TEXT_PRIMARY,fontWeight:"bold",fontFamily:"Noto Sans KR",align:y?"right":N?"center":"left",dropShadow:{color:t.BLACK_SOLID,blur:2,distance:2}},x:y?o:N?o/2:0,y:0,anchor:y?{x:1,y:0}:N?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-name-${n}`}),e.jsxs("pixiContainer",{x:0,y:C?x?20:25:5,"data-testid":`health-bar-container-${n}`,children:[e.jsx("pixiGraphics",{draw:A=>{A.clear();const g=s-(C?x?25:30:5);A.fill({color:t.UI_BACKGROUND_DARK,alpha:.9}),A.roundRect(0,0,o,g,4),A.fill(),A.stroke({width:1,color:t.ACCENT_GOLD,alpha:.3});for(let v=0;v<o;v+=20)A.moveTo(v,0),A.lineTo(v+10,g/2),A.lineTo(v,g);A.stroke(),A.stroke({width:2,color:t.ACCENT_GOLD,alpha:.8}),A.roundRect(0,0,o,g,4),A.stroke()},"data-testid":`health-bar-background-${n}`}),e.jsx("pixiGraphics",{draw:A=>{A.clear();const g=s-(C?x?25:30:5),v=o*p;if(v>0){const[Y,r]=m(),G=new he(0,0,v,0);G.addColorStop(0,Y),G.addColorStop(1,r),A.fill(G),y?A.roundRect(o-v,0,v,g,4):A.roundRect(0,0,v,g,4),A.fill(),A.fill({color:16777215,alpha:.3*(u?S:1)});const k=v*.6,P=g*.4;y?A.roundRect(o-k-4,2,k,P,2):A.roundRect(4,2,k,P,2),A.fill()}},"data-testid":`health-bar-fill-${n}`}),I&&E==="critical"&&e.jsx("pixiGraphics",{draw:A=>{A.clear(),A.stroke({width:3,color:t.ACCENT_RED,alpha:.8*M}),A.roundRect(-3,-3,o+6,s-(C?x?21:26:1),7),A.stroke(),A.fill({color:t.ACCENT_RED,alpha:.1*M}),A.roundRect(0,0,o,s-(C?x?25:30:5),4),A.fill()},"data-testid":`health-bar-critical-effect-${n}`}),e.jsx("pixiGraphics",{draw:A=>{A.clear();const g=s-(C?x?25:30:5);A.stroke({width:1,color:t.ACCENT_GOLD,alpha:.4});const v=4,Y=o/v;for(let r=1;r<v;r++){const G=Y*r;A.moveTo(G,2),A.lineTo(G,g-2),A.circle(G,g/2,2)}A.stroke()},"data-testid":`health-bar-segments-${n}`})]}),C&&e.jsx("pixiText",{text:`${Math.ceil(D)} / ${a}`,style:{fontSize:x?10:12,fill:b(),fontWeight:"bold",align:y?"right":N?"center":"left",dropShadow:{color:t.BLACK_SOLID,blur:1,distance:1}},x:y?o:N?o/2:0,y:s-(x?12:15),anchor:y?{x:1,y:0}:N?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-text-${n}`}),C&&e.jsx("pixiText",{text:E==="critical"?"위험 - 기절 직전":E==="low"?"부상 - 약한 상태":E==="medium"?"보통 - 전투 가능":"건강 - 최상 컨디션",style:{fontSize:x?7:9,fill:t.TEXT_SECONDARY,fontFamily:"Noto Sans KR",align:y?"right":N?"center":"left",fontStyle:"italic"},x:y?o-2:N?o/2:2,y:C?x?22:27:7,anchor:y?{x:1,y:0}:N?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-status-${n}`}),p>.8&&u&&e.jsx("pixiGraphics",{draw:A=>{A.clear(),A.fill({color:t.ACCENT_GREEN,alpha:.3*Math.sin(Date.now()*.008)+.3}),A.circle(y?o-10:10,(C?x?22:27:7)+5,3),A.fill()},"data-testid":`health-bar-ki-indicator-${n}`})]})},st=({timeRemaining:i,totalTime:a,currentRound:l,maxRounds:n,isPaused:c=!1,x:h,y:o,width:s,height:_,screenWidth:R,screenHeight:C,showMilliseconds:u=!1})=>{const I=R<768,{minutes:x,seconds:p,milliseconds:E,timePercentage:D,urgencyLevel:b}=T.useMemo(()=>{const N=Math.floor(i/60),S=Math.floor(i%60),M=Math.floor(i%1*100),A=a>0?i/a:0;let g="normal";return A<.1?g="critical":A<.3&&(g="warning"),{minutes:N,seconds:S,milliseconds:M,timePercentage:A,urgencyLevel:g}},[i,a]),m=()=>{if(c)return t.TEXT_SECONDARY;switch(b){case"critical":return t.ACCENT_RED;case"warning":return t.ACCENT_GOLD;default:return t.ACCENT_GREEN}},y=()=>{const N=`${x.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`;return u?`${N}.${E.toString().padStart(2,"0")}`:N};return e.jsxs(F,{x:h,y:o,screenWidth:R,screenHeight:C,"data-testid":"round-timer",children:[e.jsx(B,{title:"",x:0,y:0,width:s,height:_,screenWidth:R,screenHeight:C}),e.jsx("pixiContainer",{x:s/2,y:15,"data-testid":"round-info",children:e.jsx("pixiText",{text:`라운드 ${l} / ${n}`,style:{fontSize:I?12:14,fill:t.TEXT_PRIMARY,fontWeight:"bold",align:"center",fontFamily:"Noto Sans KR"},anchor:.5,"data-testid":"round-counter"})}),e.jsxs("pixiContainer",{x:s/2,y:_/2,"data-testid":"timer-display",children:[e.jsx("pixiGraphics",{draw:N=>{N.clear();const S=I?35:45;N.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),N.circle(0,0,S),N.fill(),N.stroke({width:4,color:m(),alpha:.9});const M=D*Math.PI*2;N.arc(0,0,S-2,-Math.PI/2,-Math.PI/2+M),N.stroke(),N.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6}),N.circle(0,0,S),N.stroke()},"data-testid":"timer-circle"}),e.jsx("pixiText",{text:y(),style:{fontSize:I?14:18,fill:m(),fontWeight:"bold",align:"center",fontFamily:"monospace"},anchor:.5,"data-testid":"timer-text"}),c&&e.jsx("pixiText",{text:"일시정지",style:{fontSize:I?8:10,fill:t.TEXT_SECONDARY,align:"center",fontFamily:"Noto Sans KR"},x:0,y:I?20:25,anchor:.5,"data-testid":"pause-indicator"})]}),e.jsx("pixiGraphics",{draw:N=>{N.clear();const S=s-20,M=4,A=_-15;N.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),N.rect(10,A,S,M),N.fill();const g=S*D;N.fill({color:m(),alpha:.9}),N.rect(10,A,g,M),N.fill(),N.stroke({width:1,color:t.ACCENT_GOLD,alpha:.6}),N.rect(10,A,S,M),N.stroke()},"data-testid":"timer-progress-bar"}),b==="critical"&&!c&&e.jsx("pixiGraphics",{draw:N=>{N.clear();const S=Math.sin(Date.now()*.01)*.3+.7;N.stroke({width:3,color:t.ACCENT_RED,alpha:S}),N.rect(2,2,s-4,_-4),N.stroke()},"data-testid":"critical-timer-effect"}),e.jsx("pixiContainer",{x:s/2,y:_-30,"data-testid":"time-label",children:e.jsx("pixiText",{text:"남은 시간",style:{fontSize:I?9:11,fill:t.TEXT_TERTIARY,align:"center",fontFamily:"Noto Sans KR"},anchor:.5,"data-testid":"time-label-korean"})})]})},ot={[f.GEON]:{korean:"건",english:"Heaven",symbol:"☰",color:t.TRIGRAM_GEON_PRIMARY,description:"직접적인 골격 타격",englishDescription:"Direct bone-striking force"},[f.TAE]:{korean:"태",english:"Lake",symbol:"☱",color:t.TRIGRAM_TAE_PRIMARY,description:"유동적인 관절 조작",englishDescription:"Fluid joint manipulation"},[f.LI]:{korean:"리",english:"Fire",symbol:"☲",color:t.TRIGRAM_LI_PRIMARY,description:"정밀한 신경 타격",englishDescription:"Precise nerve strikes"},[f.JIN]:{korean:"진",english:"Thunder",symbol:"☳",color:t.TRIGRAM_JIN_PRIMARY,description:"기절시키는 기술",englishDescription:"Stunning techniques"},[f.SON]:{korean:"손",english:"Wind",symbol:"☴",color:t.TRIGRAM_SON_PRIMARY,description:"지속적인 압박",englishDescription:"Continuous pressure"},[f.GAM]:{korean:"감",english:"Water",symbol:"☵",color:t.TRIGRAM_GAM_PRIMARY,description:"혈류 제한",englishDescription:"Blood flow restriction"},[f.GAN]:{korean:"간",english:"Mountain",symbol:"☶",color:t.TRIGRAM_GAN_PRIMARY,description:"방어적 반격",englishDescription:"Defensive counters"},[f.GON]:{korean:"곤",english:"Earth",symbol:"☷",color:t.TRIGRAM_GON_PRIMARY,description:"지상 기술",englishDescription:"Ground techniques"}},oe=({stance:i,x:a,y:l,size:n=60,showDetails:c=!0,...h})=>{const o=ot[i],s=n/2,_=T.useMemo(()=>Math.sin(Date.now()*.003)*.1+.9,[]);return e.jsxs(F,{x:a,y:l,screenWidth:n*2,screenHeight:c?n*1.8:n,"data-testid":`stance-indicator-${i}`,...h,children:[e.jsx("pixiGraphics",{draw:R=>{R.clear(),R.fill({color:o.color,alpha:.3*_}),R.circle(s,s,s+8),R.fill(),R.fill({color:o.color,alpha:.8}),R.circle(s,s,s),R.fill(),R.stroke({width:3,color:t.ACCENT_GOLD,alpha:.9}),R.circle(s,s,s),R.stroke(),R.stroke({width:2,color:t.TEXT_PRIMARY,alpha:.6}),R.circle(s,s,s-6),R.stroke()},"data-testid":`stance-circle-${i}`}),e.jsx("pixiText",{text:o.symbol,style:{fontSize:n*.4,fill:t.TEXT_PRIMARY,fontWeight:"bold",align:"center"},x:s,y:s,anchor:.5,"data-testid":`stance-symbol-${i}`}),c&&e.jsxs("pixiContainer",{x:0,y:n+10,"data-testid":`stance-details-${i}`,children:[e.jsx("pixiText",{text:`${o.korean} (${o.english})`,style:{fontSize:n*.2,fill:t.TEXT_PRIMARY,fontWeight:"bold",align:"center",fontFamily:"Noto Sans KR"},x:s,y:0,anchor:.5,"data-testid":`stance-name-${i}`}),e.jsx("pixiText",{text:o.description,style:{fontSize:n*.15,fill:t.TEXT_SECONDARY,align:"center",fontFamily:"Noto Sans KR",wordWrap:!0,wordWrapWidth:n*2},x:s,y:n*.25,anchor:.5,"data-testid":`stance-description-${i}`}),e.jsx("pixiText",{text:o.englishDescription,style:{fontSize:n*.12,fill:t.TEXT_TERTIARY,align:"center",fontStyle:"italic",wordWrap:!0,wordWrapWidth:n*2},x:s,y:n*.45,anchor:.5,"data-testid":`stance-description-english-${i}`})]}),e.jsx("pixiGraphics",{draw:R=>{R.clear(),R.fill({color:t.ACCENT_GREEN,alpha:.8*_}),R.circle(s+s*.7,s-s*.7,4),R.fill()},"data-testid":`stance-active-indicator-${i}`})]})},lt=({player1:i,player2:a,timeRemaining:l,currentRound:n,maxRounds:c,isPaused:h,onPauseToggle:o,width:s=1200,height:_=120,x:R=0,y:C=0})=>{q();const u=s<768,I=u?180:250,x=u?140:160,p=s/2,E=T.useCallback(m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_DARK,.95),m.drawRect(0,0,s,_),m.endFill(),m.lineStyle(3,t.ACCENT_GOLD,.8),m.drawRect(5,5,s-10,_-10),m.lineStyle(2,t.PRIMARY_CYAN,.6),m.moveTo(s/2,10),m.lineTo(s/2,_-10),m.beginFill(t.ACCENT_GOLD,.3),m.drawCircle(s/2,_/2,25),m.endFill(),m.beginFill(t.UI_BACKGROUND_DARK,.8),m.arc(s/2,_/2,25,0,Math.PI),m.arc(s/2,_/2-12.5,12.5,Math.PI,0,!0),m.arc(s/2,_/2+12.5,12.5,0,Math.PI,!0),m.endFill()},[s,_]),D=me[i.archetype],b=me[a.archetype];return e.jsxs("pixiContainer",{x:R,y:C,"data-testid":"combat-hud",children:[e.jsx("pixiGraphics",{draw:E}),e.jsxs("pixiContainer",{x:20,y:15,children:[e.jsx("pixiText",{text:i.name.korean,style:{fontSize:18,fill:D.colors.primary,fontWeight:"bold"}}),e.jsx("pixiText",{text:D.name.korean,style:{fontSize:12,fill:t.TEXT_SECONDARY},y:20}),e.jsx(_e,{current:i.health,max:i.maxHealth,width:I,height:25,showText:!0,x:20,y:35,position:"left",playerName:i.name.korean,screenWidth:s,screenHeight:_,"data-testid":"player1-health-bar"}),e.jsxs("pixiContainer",{y:70,children:[e.jsx("pixiText",{text:"기력",style:{fontSize:8,fill:t.TEXT_SECONDARY}}),e.jsx("pixiGraphics",{draw:m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_MEDIUM,.8),m.drawRect(25,0,100,8),m.endFill(),m.beginFill(t.PRIMARY_CYAN,.9),m.drawRect(25,0,100*(i.ki/i.maxKi),8),m.endFill()}}),e.jsx("pixiText",{text:"체력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:135}),e.jsx("pixiGraphics",{draw:m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_MEDIUM,.8),m.drawRect(160,0,100,8),m.endFill(),m.beginFill(t.SECONDARY_YELLOW,.9),m.drawRect(160,0,100*(i.stamina/i.maxStamina),8),m.endFill()}})]}),e.jsx(oe,{stance:i.currentStance,x:20,y:60,size:40,"data-testid":"player1-stance-indicator"})]}),e.jsxs("pixiContainer",{x:p-x/2,y:20,children:[e.jsx(st,{currentRound:n,maxRounds:c,timeRemaining:l,totalTime:180,width:x,height:35,x:0,y:0,isPaused:h,screenWidth:s,screenHeight:_,"data-testid":"round-timer"}),e.jsx("pixiText",{text:`라운드 ${n}/${c}`,style:{fontSize:14,fill:t.ACCENT_GOLD,align:"center",fontWeight:"bold"},x:80,y:45,anchor:.5}),Array.from({length:c},(m,y)=>e.jsx("pixiGraphics",{draw:N=>{N.clear();const S=y<n;N.beginFill(S?t.ACCENT_GOLD:t.UI_GRAY,.8),N.drawCircle(40+y*20,65,6),N.endFill()}},y))]}),e.jsxs("pixiContainer",{x:s-320,y:15,children:[e.jsx("pixiText",{text:a.name.korean,style:{fontSize:18,fill:b.colors.primary,fontWeight:"bold",align:"right"},x:280,anchor:{x:1,y:0}}),e.jsx("pixiText",{text:b.name.korean,style:{fontSize:12,fill:t.TEXT_SECONDARY,align:"right"},x:280,y:20,anchor:{x:1,y:0}}),e.jsx(_e,{current:a.health,max:a.maxHealth,width:I,height:25,showText:!0,x:s-I-20,y:35,position:"right",playerName:a.name.korean,screenWidth:s,screenHeight:_,"data-testid":"player2-health-bar"}),e.jsxs("pixiContainer",{y:70,children:[e.jsx("pixiText",{text:"기력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:30}),e.jsx("pixiGraphics",{draw:m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_MEDIUM,.8),m.drawRect(55,0,100,8),m.endFill(),m.beginFill(t.PRIMARY_CYAN,.9),m.drawRect(55,0,100*(a.ki/a.maxKi),8),m.endFill()}}),e.jsx("pixiText",{text:"체력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:165}),e.jsx("pixiGraphics",{draw:m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_MEDIUM,.8),m.drawRect(190,0,100,8),m.endFill(),m.beginFill(t.SECONDARY_YELLOW,.9),m.drawRect(190,0,100*(a.stamina/a.maxStamina),8),m.endFill()}})]}),e.jsx(oe,{stance:a.currentStance,x:s-60,y:60,size:40,"data-testid":"player2-stance-indicator"})]}),o&&e.jsxs("pixiContainer",{x:s-80,y:_-40,children:[e.jsx("pixiGraphics",{draw:m=>{m.clear(),m.beginFill(t.UI_BACKGROUND_MEDIUM,.9),m.lineStyle(2,t.ACCENT_GOLD,.8),m.drawRoundedRect(0,0,60,30,5),m.endFill()},interactive:!0,onPointerDown:o}),e.jsx("pixiText",{text:h?"계속":"정지",style:{fontSize:10,fill:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:30,y:15,anchor:.5})]})]})},ct=({effects:i,onEffectComplete:a})=>{q();const[l,n]=T.useState([]);return T.useEffect(()=>{const c=i.map(h=>({...h,opacity:Math.max(0,1-(Date.now()-h.timestamp)/h.duration),scale:1+(Date.now()-h.timestamp)/h.duration*.5,startTime:h.timestamp,displayAlpha:1,displayY:h.position?.y||0,displaySize:1,attackerId:h.attackerId||"unknown",defenderId:h.defenderId||"unknown"}));n(c),i.forEach(h=>{Date.now()-h.timestamp>h.duration&&a(h.id)})},[i,a]),e.jsx("pixiContainer",{"data-testid":"hit-effects-layer",children:l.map(c=>e.jsx("pixiContainer",{x:c.position?.x||0,y:c.displayY,alpha:c.opacity,children:e.jsx("pixiText",{text:c.text||c.type,style:{fontSize:16*c.scale,fill:t.CRITICAL_HIT,fontWeight:"bold",align:"center"},anchor:.5})},c.id))})};le({Container:ue,Graphics:de,Text:ce,Sprite:Ee});const je=({width:i,height:a,lighting:l="normal",animate:n=!0,...c})=>{const[h,o]=T.useState(null),[s,_]=T.useState(null);T.useEffect(()=>{let x=!1;return(async()=>{try{const[E,D]=await Promise.all([H.load("/src/assets/visual/bg/dojang/dojang_floor_tex.png"),H.load("/src/assets/visual/bg/dojang/dojang_wall_tex.png")]);x||(o(E),_(D))}catch{}})(),()=>{x=!0}},[]);const R=T.useCallback(x=>{switch(x){case"dim":return{backgroundAlpha:.7,gridAlpha:.2,accentAlpha:.3,ambientColor:t.UI_BACKGROUND_DARK,tintColor:4473924};case"bright":return{backgroundAlpha:1,gridAlpha:.5,accentAlpha:.7,ambientColor:t.UI_BACKGROUND_LIGHT,tintColor:16777215};case"cyberpunk":return{backgroundAlpha:.95,gridAlpha:.4,accentAlpha:.8,ambientColor:t.NEON_CYAN,tintColor:65535};case"traditional":return{backgroundAlpha:.9,gridAlpha:.3,accentAlpha:.6,ambientColor:t.KOREAN_RED,tintColor:11176038};default:return{backgroundAlpha:.9,gridAlpha:.3,accentAlpha:.4,ambientColor:t.UI_BACKGROUND_DARK,tintColor:16777215}}},[]),C=T.useCallback(x=>{x.clear();const p=R(l);x.fill({color:p.ambientColor,alpha:p.backgroundAlpha}),x.rect(0,0,i,a),x.fill()},[i,a,l,R]),u=T.useCallback(x=>{x.clear();const p=R(l);x.stroke({width:1,color:l==="cyberpunk"?t.NEON_CYAN:t.ACCENT_GOLD,alpha:p.gridAlpha});const E=60;for(let y=0;y<i;y+=E)x.moveTo(y,0),x.lineTo(y,a);for(let y=0;y<a;y+=E)x.moveTo(0,y),x.lineTo(i,y);x.stroke();const D=l==="cyberpunk"?t.NEON_PURPLE:l==="traditional"?t.KOREAN_BLUE:t.PRIMARY_CYAN;x.stroke({width:3,color:D,alpha:.6}),x.circle(i/2,a/2,Math.min(i,a)*.2),x.stroke();const b=40,m=l==="cyberpunk"?t.NEON_PINK:l==="traditional"?t.KOREAN_RED:t.ACCENT_GOLD;x.fill({color:m,alpha:p.accentAlpha}),x.rect(0,0,b,b),x.rect(i-b,0,b,b),x.rect(0,a-b,b,b),x.rect(i-b,a-b,b,b),x.fill(),l==="cyberpunk"&&(x.stroke({width:2,color:t.NEON_CYAN,alpha:.8}),x.moveTo(0,a*.25),x.lineTo(i,a*.25),x.moveTo(0,a*.75),x.lineTo(i,a*.75),x.stroke(),x.fill({color:t.NEON_PURPLE,alpha:.2}),x.circle(i/2,a/2,Math.min(i,a)*.1),x.fill()),l==="traditional"&&(x.stroke({width:4,color:t.KOREAN_BLUE,alpha:.6}),x.rect(20,20,i-40,a-40),x.stroke(),x.fill({color:t.KOREAN_BLACK,alpha:.3}),x.circle(i/2,a/2,30),x.fill(),x.fill({color:t.KOREAN_WHITE,alpha:.3}),x.arc(i/2,a/2,30,0,Math.PI),x.fill())},[i,a,l,R]),I=R(l);return e.jsxs("pixiContainer",{...c,children:[h?e.jsx("pixiSprite",{texture:h,x:0,y:0,width:i,height:a,alpha:I.backgroundAlpha,tint:I.tintColor,"data-testid":"dojang-floor-texture"}):e.jsx("pixiGraphics",{draw:C,"data-testid":"dojang-fallback-background"}),s&&l==="traditional"&&e.jsx("pixiSprite",{texture:s,x:i*.8,y:0,width:i*.3,height:a,alpha:.3,tint:I.tintColor,"data-testid":"dojang-wall-texture"}),e.jsx("pixiGraphics",{draw:u,"data-testid":"dojang-overlay"})]})},Te=({player:i,position:a,...l})=>J.createElement("pixiContainer",l,J.createElement("pixiText",{text:`${i.name.korean} - ${a}`,style:{fontSize:14,fill:16777215}})),dt=({players:i,combatLog:a,...l})=>J.createElement("pixiContainer",l,J.createElement("pixiText",{text:"Combat Stats",style:{fontSize:16,fill:16766720}}),...(a||[]).slice(0,3).map((n,c)=>J.createElement("pixiText",{key:c,text:n,style:{fontSize:12,fill:13421772},y:20+c*15}))),yt=({players:i,onPlayerUpdate:a,currentRound:l,timeRemaining:n,isPaused:c,onReturnToMenu:h,onGameEnd:o,width:s=1200,height:_=800,x:R=0,y:C=0})=>{const[u,I]=T.useState([]),[x,p]=T.useState(!1),[E,D]=T.useState(null),[b]=T.useState([]),m=T.useCallback((d,j,O,w)=>({id:d,type:j,attackerId:"player1",defenderId:"player2",timestamp:Date.now(),duration:1e3,position:O,intensity:w,startTime:Date.now()}),[]),y=T.useCallback(()=>{const d=m(`attack_${Date.now()}`,"hit",{x:400,y:300},1);I(j=>[...j,d])},[m]),N=T.useCallback(()=>{},[]),S=T.useCallback(d=>{p(!0),setTimeout(()=>p(!1),500)},[]),M=T.useCallback(d=>{p(!0),a(0,{currentStance:d})},[a]),A=T.useCallback(()=>{},[]),g=T.useCallback(()=>{p(!0),setTimeout(()=>p(!1),800)},[]),v=T.useCallback(d=>{I(j=>j.filter(O=>O.id!==d))},[]),Y=T.useMemo(()=>{if(i.length<2){const d={...i[0],id:"dummy_player",name:{korean:"더미",english:"Dummy"}};return[i[0],d]}return[i[0],i[1]]},[i]),r=T.useCallback((d,j)=>{const O=m(`effect_${Date.now()}`,d,j,1);I(w=>[...w,O])},[m]),G=T.useCallback(()=>{Y[0].health<=0?o(1):Y[1].health<=0&&o(0)},[Y,o]);J.useEffect(()=>{G()},[G]);const{isMobile:k,isTablet:P}=T.useMemo(()=>{const d=s<768,j=s>=768&&s<1024;return{isMobile:d,isTablet:j}},[s,_]),ie=d=>{D(d),r("hit",{x:100+d*200,y:200})};return e.jsxs(F,{x:R,y:C,"data-testid":"combat-screen",children:[e.jsx(je,{width:s,height:_,lighting:"cyberpunk",animate:!0}),e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.stroke({width:1,color:t.ACCENT_GOLD,alpha:.1});const j=k?100:P?125:150,O=k?25:P?32:40;for(let w=0;w<s;w+=j)for(let Z=0;Z<_;Z+=j)d.circle(w+j/2,Z+j/2,O),d.stroke()}}),e.jsx(nt,{players:Y,width:s,height:_*(k?.65:.75),y:_*(k?.2:.15),onPlayerClick:ie}),e.jsx(lt,{player1:Y[0],player2:Y[1],currentRound:l,timeRemaining:n,maxRounds:3,isPaused:c,width:s,height:k?80:120,y:0}),e.jsx(B,{title:Y[0].name.korean,x:k?10:20,y:_*(k?.15:.2),width:k?s*.4:180,height:k?200:300,"data-testid":"player1-status",children:e.jsx(Te,{player:Y[0],position:"left",x:0,y:0,width:k?s*.4-20:160,height:k?180:280,isSelected:E===0})}),e.jsx(B,{title:Y[1].name.korean,x:s-(k?s*.4+10:200),y:_*(k?.15:.2),width:k?s*.4:180,height:k?200:300,"data-testid":"player2-status",children:e.jsx(Te,{player:Y[1],position:"right",x:0,y:0,width:k?s*.4-20:160,height:k?180:280,isSelected:E===1})}),e.jsx(B,{title:"전투 통계",x:k?10:s/2-150,y:_-(k?160:180),width:k?s-20:300,height:k?100:160,"data-testid":"combat-stats-panel",children:e.jsx(dt,{players:Y,combatLog:b,x:0,y:0,width:k?s-40:280,height:k?80:140})}),e.jsx(F,{x:k?10:20,y:_-(k?50:140),"data-testid":"combat-controls-container",children:e.jsx(rt,{onAttack:y,onDefend:N,onSwitchStance:M,onPauseToggle:g,isPaused:c,player:Y[0],onTechniqueExecute:S,onGuard:A,isExecutingTechnique:x,width:k?s-20:400,height:k?40:120,x:0,y:0})}),e.jsx(ct,{effects:u,onEffectComplete:v}),e.jsx(z,{text:"메뉴로",x:s-(k?80:150),y:k?10:20,width:k?70:120,height:k?35:45,variant:"secondary",onClick:h,"data-testid":"return-menu-button"}),c&&e.jsxs(F,{x:0,y:0,"data-testid":"pause-overlay",children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),d.rect(0,0,s,_),d.fill()}}),e.jsx("pixiText",{text:"일시 정지",style:{fontSize:k?32:48,fill:t.ACCENT_GOLD,fontWeight:"bold",align:"center"},x:s/2,y:_/2-30,anchor:.5}),e.jsx("pixiText",{text:"PAUSED",style:{fontSize:k?16:24,fill:t.TEXT_SECONDARY,align:"center"},x:s/2,y:_/2+20,anchor:.5})]})]})},Re=({onBack:i,x:a=0,y:l=0,width:n=800,height:c=600})=>(q(),e.jsxs("pixiContainer",{x:a,y:l,"data-testid":"philosophy-section",children:[e.jsx("pixiGraphics",{draw:o=>{o.clear(),o.beginFill(t.UI_BACKGROUND_DARK,.95),o.drawRoundedRect(0,0,n,c,10),o.endFill(),o.lineStyle(2,t.ACCENT_GOLD,.6),o.drawRoundedRect(0,0,n,c,10)}}),e.jsx("pixiText",{text:"무술 철학 (Martial Philosophy)",style:new X({fontSize:32,fill:t.ACCENT_GOLD,fontFamily:"Arial, sans-serif",align:"center"}),x:n/2,y:40,anchor:.5}),e.jsx("pixiText",{text:`
흑괘 (Black Trigram) - 한국 무술의 철학

팔괘는 고대 중국의 역경(I Ching)에서 유래한 
여덟 가지 기본 기호로, 우주의 모든 현상을 
나타냅니다. 한국 무술에서는 이를 전투 자세와 
연결하여 몸과 마음의 조화를 추구합니다.

• 건 (☰) - 하늘: 직접적인 힘
• 태 (☱) - 호수: 유연한 적응
• 리 (☲) - 불: 정밀한 공격
• 진 (☳) - 천둥: 폭발적인 힘
• 손 (☴) - 바람: 지속적인 압박
• 감 (☵) - 물: 흐름과 반격
• 간 (☶) - 산: 견고한 방어
• 곤 (☷) - 땅: 포용과 제압

무술은 단순한 격투가 아닌, 자신을 수양하고
상대를 존중하는 도(道)입니다.
  `,style:new X({fontSize:16,fill:t.TEXT_PRIMARY,fontFamily:"Arial, sans-serif",align:"left",wordWrap:!0,wordWrapWidth:n-80,lineHeight:24}),x:40,y:100}),e.jsxs("pixiContainer",{x:n-150,y:c-80,children:[e.jsx("pixiGraphics",{draw:o=>{o.clear(),o.beginFill(t.ACCENT_RED,.8),o.drawRoundedRect(0,0,120,40,5),o.endFill()},interactive:!0,onPointerDown:i}),e.jsx("pixiText",{text:"돌아가기",style:new X({fontSize:16,fill:t.TEXT_PRIMARY,align:"center"}),x:60,y:20,anchor:.5})]})]})),ut=Object.freeze(Object.defineProperty({__proto__:null,PhilosophySection:Re,default:Re},Symbol.toStringTag,{value:"Module"})),Ae=({onBack:i,x:a=0,y:l=0,width:n=800,height:c=600})=>{const h=n<768,o=n>=768&&n<1024;return e.jsxs(B,{title:"조작법 (Controls)",x:a,y:l,width:n,height:c,screenWidth:n,screenHeight:c,"data-testid":"controls-section",children:[e.jsxs(F,{x:0,y:0,screenWidth:n,screenHeight:c,"data-testid":"trigram-controls",children:[e.jsx("pixiText",{text:"팔괘 자세 (Trigram Stances)",style:{fontSize:h?18:24,fill:t.TEXT_PRIMARY,fontFamily:"Arial, sans-serif",fontWeight:"bold"},x:20,y:0}),e.jsx(F,{x:20,y:35,screenWidth:n,screenHeight:c,"data-testid":"stance-controls-grid",children:Object.entries(pe.stanceControls).map(([s,_],R)=>{const C=h?2:4,u=h?160:180,I=h?40:35,x=R%C*(u+10),p=Math.floor(R/C)*(I+10);return e.jsxs(F,{x,y:p,screenWidth:n,screenHeight:c,"data-testid":`stance-control-${s}`,children:[e.jsx("pixiGraphics",{draw:E=>{E.clear(),E.fill({color:t.UI_BACKGROUND_MEDIUM,alpha:.8}),E.roundRect(0,0,u,I,6),E.fill(),E.stroke({width:1,color:t.ACCENT_GOLD,alpha:.6}),E.roundRect(0,0,u,I,6),E.stroke()}}),e.jsx("pixiText",{text:`${s}: ${_.korean} (${_.technique})`,style:{fontSize:h?10:12,fill:t.TEXT_SECONDARY,fontFamily:"Arial, sans-serif"},x:8,y:I/2,anchor:{x:0,y:.5}})]},s)})})]}),e.jsxs(F,{x:0,y:c*.5,screenWidth:n,screenHeight:c,"data-testid":"combat-controls",children:[e.jsx("pixiText",{text:"전투 조작 (Combat Controls)",style:{fontSize:h?18:24,fill:t.TEXT_PRIMARY,fontFamily:"Arial, sans-serif",fontWeight:"bold"},x:20,y:0}),Object.entries(pe.combat).map(([s,_],R)=>e.jsxs(F,{x:20,y:35+R*(h?25:30),screenWidth:n,screenHeight:c,"data-testid":`combat-control-${s}`,children:[e.jsx("pixiGraphics",{draw:C=>{C.clear(),C.fill({color:t.UI_BACKGROUND_LIGHT,alpha:.6}),C.roundRect(0,0,n-80,h?20:25,4),C.fill()}}),e.jsx("pixiText",{text:`${s}: ${_}`,style:{fontSize:h?11:14,fill:t.TEXT_SECONDARY,fontFamily:"Arial, sans-serif"},x:8,y:(h?20:25)/2,anchor:{x:0,y:.5}})]},s))]}),e.jsx(z,{text:"돌아가기",x:n-150,y:c-80,width:120,height:40,screenWidth:n,screenHeight:c,variant:"secondary",onClick:i,"data-testid":"controls-back-button"})]})},ht=Object.freeze(Object.defineProperty({__proto__:null,ControlsSection:Ae,default:Ae},Symbol.toStringTag,{value:"Module"})),Ce=({winner:i,matchStatistics:a,onReturnToMenu:l,onRestart:n,width:c,height:h})=>{const{isMobile:o}=T.useMemo(()=>({isMobile:c<768}),[c]);return e.jsxs(F,{screenWidth:c,screenHeight:h,"data-testid":"end-screen",children:[e.jsx("pixiGraphics",{draw:s=>{s.clear();const _=new he(0,0,c,h);_.addColorStop(0,657935),_.addColorStop(.5,1710638),_.addColorStop(1,986915),s.fill(_),s.rect(0,0,c,h),s.fill()}}),e.jsxs("pixiContainer",{x:c/2,y:o?60:100,"data-testid":"victory-title",children:[e.jsx("pixiText",{text:"승리! - Victory!",style:{fontSize:o?32:48,fill:t.ACCENT_GOLD,fontWeight:"bold",align:"center"},anchor:.5}),e.jsx("pixiText",{text:`${i.name.korean} (${i.name.english})`,style:{fontSize:o?20:28,fill:t.PRIMARY_CYAN,align:"center"},x:0,y:o?40:60,anchor:.5})]}),e.jsxs(B,{title:"전투 통계 - Match Statistics",x:c/2-(o?c*.45:200),y:o?150:200,width:o?c*.9:400,height:o?250:300,screenWidth:c,screenHeight:h,"data-testid":"match-statistics",children:[e.jsx("pixiText",{text:`경기 시간: ${Math.floor(a.matchDuration/60)}:${(a.matchDuration%60).toString().padStart(2,"0")}`,style:{fontSize:o?12:14,fill:t.TEXT_PRIMARY},x:20,y:40}),e.jsx("pixiText",{text:`총 라운드: ${a.totalRounds}`,style:{fontSize:o?12:14,fill:t.TEXT_PRIMARY},x:20,y:60}),e.jsx("pixiText",{text:`치명타: ${a.criticalHits}`,style:{fontSize:o?12:14,fill:t.SECONDARY_MAGENTA},x:20,y:80}),e.jsx("pixiText",{text:`급소 공격: ${a.vitalPointHits}`,style:{fontSize:o?12:14,fill:t.ACCENT_CYAN},x:20,y:100}),e.jsx("pixiText",{text:`완벽한 일격: ${a.perfectStrikes}`,style:{fontSize:o?12:14,fill:t.ACCENT_GOLD},x:20,y:120}),e.jsx("pixiText",{text:`사용된 기술: ${a.techniquesUsed}`,style:{fontSize:o?12:14,fill:t.TEXT_SECONDARY},x:20,y:140}),e.jsx("pixiText",{text:"승자 세부 정보 - Winner Details",style:{fontSize:o?14:16,fill:t.ACCENT_GOLD,fontWeight:"bold"},x:20,y:170}),e.jsx("pixiText",{text:`유형: ${i.archetype}`,style:{fontSize:o?12:14,fill:t.TEXT_PRIMARY},x:20,y:195}),e.jsx("pixiText",{text:`최종 체력: ${i.health}/${i.maxHealth}`,style:{fontSize:o?12:14,fill:t.PRIMARY_CYAN},x:20,y:215})]}),e.jsxs(F,{x:c/2,y:h-(o?100:120),screenWidth:c,screenHeight:h,"data-testid":"end-screen-actions",children:[e.jsx(z,{text:"다시 시작 - Restart",x:-(o?100:120),y:0,width:o?90:110,height:o?40:50,screenWidth:c,screenHeight:h,variant:"primary",onClick:n,"data-testid":"restart-button"}),e.jsx(z,{text:"메뉴로 - Menu",x:20,y:0,width:o?90:110,height:o?40:50,screenWidth:c,screenHeight:h,variant:"secondary",onClick:l,"data-testid":"return-menu-button"})]}),e.jsx("pixiContainer",{x:c/2,y:h-(o?40:50),"data-testid":"end-screen-footer",children:e.jsx("pixiText",{text:"흑괘의 길을 완주하셨습니다 - You have completed the Path of the Black Trigram",style:{fontSize:o?10:12,fill:t.TEXT_SECONDARY,align:"center",fontStyle:"italic"},anchor:.5})})]})},_t=Object.freeze(Object.defineProperty({__proto__:null,EndScreen:Ce,default:Ce},Symbol.toStringTag,{value:"Module"}));le({Container:ue,Graphics:de,Text:ce});const Oe=i=>{const{width:a=0,height:l=0,player:n,onPlayerUpdate:c,onReturnToMenu:h,x:o=0,y:s=0}=i,_=be(),[R,C]=T.useState(f.GEON),[u,I]=T.useState(!1),[x,p]=T.useState("basics"),[E,D]=T.useState({techniquesExecuted:0,perfectStrikes:0,totalDamage:0,sessionTime:0,attempts:0}),[b,m]=T.useState({health:100,maxHealth:100,position:{x:a*.7,y:l*.5},isActive:!0}),{isMobile:y}=T.useMemo(()=>({isMobile:a<768}),[a]);T.useEffect(()=>{let r;return u&&(r=setInterval(()=>{D(G=>({...G,sessionTime:G.sessionTime+1}))},1e3)),()=>{r&&clearInterval(r)}},[u]);const N=T.useCallback(()=>{if(b.isActive)try{const r=Math.random()*20+10,G=Math.random()>.7,k=G?r*1.5:r;m(P=>({...P,health:Math.max(0,P.health-k)})),D(P=>({...P,techniquesExecuted:P.techniquesExecuted+1,attempts:P.attempts+1,perfectStrikes:G?P.perfectStrikes+1:P.perfectStrikes,totalDamage:P.totalDamage+k}));try{G?_.playSFX("perfect_strike"):_.playSFX("attack_medium")}catch{}try{c({experiencePoints:(n.experiencePoints||0)+(G?15:10),health:n.health,stamina:Math.max(0,n.stamina-5),balance:n.balance,consciousness:n.consciousness,pain:n.pain})}catch{}b.health-k<=0&&setTimeout(()=>{m(P=>({...P,health:P.maxHealth}))},2e3)}catch{}},[b,_,c,n]),S=T.useCallback(r=>{C(r),c({currentStance:r}),_.playSFX("stance_change")},[c,_]),M=T.useCallback(()=>{I(!u),u?_.playSFX("match_end"):(D({techniquesExecuted:0,perfectStrikes:0,totalDamage:0,sessionTime:0,attempts:0}),_.playSFX("match_start"))},[u,_]),A=T.useCallback(()=>{m(r=>({...r,health:r.maxHealth})),_.playSFX("ki_charge")},[_]),g=T.useCallback(()=>{_.playSFX("menu_select")},[_]),v=T.useCallback(r=>({[f.GEON]:{korean:"건",technique:"천둥벽력"},[f.TAE]:{korean:"태",technique:"유수연타"},[f.LI]:{korean:"리",technique:"화염지창"},[f.JIN]:{korean:"진",technique:"벽력일섬"},[f.SON]:{korean:"손",technique:"선풍연격"},[f.GAM]:{korean:"감",technique:"수류반격"},[f.GAN]:{korean:"간",technique:"반석방어"},[f.GON]:{korean:"곤",technique:"대지포옹"}})[r]||{korean:"Unknown",technique:"Unknown"},[]),Y=Object.values(f);return e.jsxs(F,{x:o,y:s,screenWidth:a,screenHeight:l,"data-testid":"training-screen",children:[e.jsx(je,{width:a,height:l,lighting:"normal",animate:!0,"data-testid":"dojang-background"}),e.jsx("pixiContainer",{x:a/2,y:30,"data-testid":"training-header",children:e.jsx("pixiText",{text:"흑괘 무술 도장",style:{fontSize:y?20:24,fill:t.ACCENT_GOLD,fontWeight:"bold",align:"center"},anchor:.5,"data-testid":"training-title"})}),e.jsx("pixiContainer",{"data-testid":"training-area",children:e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.stroke({width:1,color:t.ACCENT_GOLD,alpha:.2});const G=y?40:60;for(let k=0;k<a;k+=G)r.moveTo(k,0),r.lineTo(k,l);for(let k=0;k<l;k+=G)r.moveTo(0,k),r.lineTo(a,k);r.stroke(),r.stroke({width:3,color:t.PRIMARY_CYAN,alpha:.5}),r.circle(a*.5,l*.6,Math.min(a,l)*.15),r.stroke()},"data-testid":"training-grid"})}),e.jsxs(B,{title:"수련 모드 선택",x:y?10:20,y:y?60:80,width:y?a*.45:250,height:y?100:120,screenWidth:a,screenHeight:l,"data-testid":"training-mode-stances",children:[e.jsx("pixiText",{text:"훈련 모드:",style:{fontSize:y?10:12,fill:t.TEXT_PRIMARY},x:10,y:10,"data-testid":"mode-title"}),e.jsx(z,{text:"기초",x:10,y:30,width:60,height:25,screenWidth:a,screenHeight:l,variant:x==="basics"?"primary":"secondary",onClick:()=>p("basics"),"data-testid":"mode-basics"}),e.jsx(z,{text:"고급",x:80,y:30,width:60,height:25,screenWidth:a,screenHeight:l,variant:x==="advanced"?"primary":"secondary",onClick:()=>p("advanced"),"data-testid":"mode-advanced"}),e.jsx(z,{text:"자유",x:150,y:30,width:60,height:25,screenWidth:a,screenHeight:l,variant:x==="free"?"primary":"secondary",onClick:()=>p("free"),"data-testid":"mode-free"}),e.jsx("pixiText",{text:`현재 모드: ${x}`,style:{fontSize:y?8:10,fill:t.TEXT_SECONDARY},x:10,y:65,"data-testid":"training-mode-display"})]}),e.jsxs("pixiContainer",{x:a*.25,y:l*.5,"data-testid":"training-player",children:[e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.fill({color:t.PRIMARY_CYAN,alpha:.8}),r.circle(0,-40,15),r.rect(-8,-25,16,40),r.rect(-6,15,5,25),r.rect(1,15,5,25),r.rect(-15,-20,10,5),r.rect(5,-20,10,5),r.fill(),r.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6}),r.circle(0,-40,15),r.rect(-8,-25,16,40),r.stroke(),u&&(r.fill({color:t.ACCENT_GREEN,alpha:.3}),r.circle(0,0,50),r.fill())},scale:{x:y?.8:1,y:y?.8:1}}),e.jsx("pixiText",{text:n.name.korean,style:{fontSize:y?12:14,fill:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:0,y:-80,anchor:.5})]}),e.jsxs(F,{x:b.position.x,y:b.position.y,screenWidth:a,screenHeight:l,"data-testid":"training-dummy-container",children:[e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.fill({color:t.UI_BACKGROUND_MEDIUM,alpha:.8}),r.roundRect(-30,-60,60,120,10),r.fill(),r.fill({color:t.UI_BACKGROUND_LIGHT,alpha:.9}),r.circle(0,-80,25),r.fill(),r.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6}),r.circle(0,-80,15),r.circle(0,-40,10),r.circle(0,-10,8),r.circle(0,20,12),r.stroke(),b.health<b.maxHealth&&(r.fill({color:t.ACCENT_RED,alpha:.4}),r.circle(0,0,40),r.fill())},interactive:!0,onPointerDown:N,"data-testid":"training-dummy"}),e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),r.rect(-40,-100,80,8),r.fill();const G=b.health/b.maxHealth;r.fill({color:G>.5?t.ACCENT_GREEN:G>.25?t.ACCENT_GOLD:t.ACCENT_RED,alpha:.9}),r.rect(-40,-100,80*G,8),r.fill(),r.stroke({width:1,color:t.ACCENT_GOLD,alpha:.8}),r.rect(-40,-100,80,8),r.stroke()}}),e.jsx("pixiText",{text:`${Math.ceil(b.health)}/${b.maxHealth}`,style:{fontSize:y?10:12,fill:t.TEXT_PRIMARY,align:"center"},x:0,y:-115,anchor:.5})]}),e.jsx(F,{"data-testid":"training-trigram-wheel",x:1050,y:650,children:Y.map(r=>e.jsx("pixiContainer",{"data-testid":`trigram-stance-${r}`,interactive:!0,onPointerDown:()=>S(r),children:e.jsx("pixiText",{text:r,style:{fontSize:14,fill:t.TEXT_PRIMARY},anchor:.5})},r))}),e.jsxs("pixiContainer",{x:a-(y?120:150),y:l-(y?200:220),"data-testid":"stance-selection",children:[e.jsx("pixiText",{text:"자세 선택",style:{fontSize:y?10:12,fill:t.TEXT_SECONDARY,align:"center"},anchor:.5}),e.jsx(z,{text:"건",x:-40,y:20,width:25,height:25,screenWidth:a,screenHeight:l,variant:R===f.GEON?"primary":"secondary",onClick:()=>S(f.GEON),"data-testid":"stance-geon-button"})]}),e.jsx(oe,{stance:R,x:y?a/2:a*.25,y:l-(y?120:140),"data-testid":"current-stance-indicator"}),e.jsxs(B,{title:"훈련 제어",x:y?10:20,y:y?200:220,width:y?a*.45:250,height:y?140:180,screenWidth:a,screenHeight:l,"data-testid":"training-controls",children:[e.jsx(z,{text:u?"훈련 정지":"훈련 시작",x:10,y:10,width:y?a*.35:200,height:35,screenWidth:a,screenHeight:l,variant:u?"secondary":"primary",onClick:M,"data-testid":"start-training-button"}),u&&e.jsx(z,{text:`${v(R).technique} 실행`,x:10,y:55,width:y?a*.35:200,height:35,screenWidth:a,screenHeight:l,variant:"primary",onClick:N,"data-testid":"execute-technique-button"}),e.jsx(z,{text:"더미 리셋",x:10,y:100,width:y?a*.35:200,height:30,screenWidth:a,screenHeight:l,variant:"secondary",onClick:A,"data-testid":"reset-dummy-button"}),e.jsx(z,{text:"평가",x:10,y:140,width:y?a*.35:200,height:30,screenWidth:a,screenHeight:l,variant:"secondary",onClick:g,"data-testid":"evaluate-button"})]}),e.jsxs(B,{title:"훈련 통계",x:a-(y?a*.45+10:270),y:y?200:220,width:y?a*.45:250,height:y?140:180,screenWidth:a,screenHeight:l,"data-testid":"training-stats-panel",children:[e.jsx("pixiText",{text:"훈련 통계",style:{fontSize:y?10:12,fill:t.ACCENT_GOLD,fontWeight:"bold"},x:10,y:-5,"data-testid":"stats-title"}),e.jsx("pixiText",{text:`시도: ${E.attempts}`,style:{fontSize:y?10:12,fill:t.TEXT_PRIMARY},x:10,y:15,"data-testid":"attempts-count"}),e.jsx("pixiText",{text:`기술 실행: ${E.techniquesExecuted}`,style:{fontSize:y?10:12,fill:t.TEXT_PRIMARY},x:10,y:35}),e.jsx("pixiText",{text:`완벽한 타격: ${E.perfectStrikes}`,style:{fontSize:y?10:12,fill:t.ACCENT_GREEN},x:10,y:55}),e.jsx("pixiText",{text:`총 데미지: ${Math.ceil(E.totalDamage)}`,style:{fontSize:y?10:12,fill:t.ACCENT_GOLD},x:10,y:75}),e.jsx("pixiText",{text:`세션 시간: ${Math.floor(E.sessionTime/60)}:${String(E.sessionTime%60).padStart(2,"0")}`,style:{fontSize:y?10:12,fill:t.TEXT_SECONDARY},x:10,y:95,"data-testid":"session-time"}),e.jsx("pixiText",{text:`현재 자세: ${v(R).korean}`,style:{fontSize:y?10:12,fill:t.PRIMARY_CYAN,fontWeight:"bold"},x:10,y:115}),e.jsx("pixiText",{text:`경험치: ${n.experiencePoints||0}`,style:{fontSize:y?10:12,fill:t.ACCENT_CYAN},x:10,y:135}),e.jsx("pixiText",{text:"계속 연습하세요!",style:{fontSize:y?8:10,fill:t.TEXT_SECONDARY,fontStyle:"italic"},x:10,y:155,"data-testid":"feedback-message"})]}),e.jsx(z,{text:"메뉴로 돌아가기",x:y?a/2-80:a/2-100,y:l-(y?40:50),width:y?160:200,height:y?30:40,screenWidth:a,screenHeight:l,variant:"secondary",onClick:h,"data-testid":"return-to-menu-button"}),u&&e.jsxs("pixiContainer",{x:a/2,y:50,"data-testid":"training-status",children:[e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.fill({color:t.ACCENT_GREEN,alpha:.8}),r.roundRect(-60,-15,120,30,8),r.fill()}}),e.jsx("pixiText",{text:"훈련 중",style:{fontSize:y?14:16,fill:t.BLACK_SOLID,fontWeight:"bold",align:"center"},anchor:.5})]})]})},xt=i=>e.jsx(qe,{children:e.jsx(Oe,{...i,width:i.width,height:i.height})}),Tt=Object.freeze(Object.defineProperty({__proto__:null,TrainingScreen:Oe,default:xt},Symbol.toStringTag,{value:"Module"}));export{qe as A,Ve as C,_t as E,$ as G,ft as I,me as P,Tt as T,Se as _,V as a,yt as b,q as u};
