const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PhilosophySection-C_EzlL.js","./react-vendor-JTlySM.js","./vendor-B8FTWQ.js","./game-core-CB5abc.js","./pixi-vendor-CIJP7N.js","./korean-data-MM66We.js","./ControlsSection-CzofwS.js","./screens-DnjLBe.js","./audio-XllvSq.js"])))=>i.map(i=>d[i]);
import{r as x,j as e,a as L,b as le}from"./react-vendor-JTlySM.js";import{_ as H,d as ce,F as ie,c as U,f as de}from"./pixi-vendor-CIJP7N.js";import{K as t,u as Y,G as O,a as xe,D as pe,P as V,c as K,b as B}from"./game-core-CB5abc.js";import{u as he,A as ne}from"./audio-XllvSq.js";import"./korean-data-MM66We.js";import{R as W,a as $,S as J,D as ue,b as ye}from"./screens-DnjLBe.js";import"./vendor-B8FTWQ.js";(function(){const C=document.createElement("link").relList;if(C&&C.supports&&C.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const p of l)if(p.type==="childList")for(const s of p.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function j(l){const p={};return l.integrity&&(p.integrity=l.integrity),l.referrerPolicy&&(p.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?p.credentials="include":l.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function n(l){if(l.ep)return;l.ep=!0;const p=j(l);fetch(l.href,p)}})();function me(a){typeof window<"u"&&(window.blackTrigramApp=a,window.pixiApp=a,window.__PIXI_APP__=a,window.blackTrigramApp={pixiApp:a,version:"1.0.0",gameState:"intro"})}const Q=({selectedMode:a,onModeSelect:C,onStartGame:j,onShowPhilosophy:n,onShowControls:l,width:p,height:s,x:o,y:S,menuItems:k})=>{const T=x.useCallback(()=>{},[]);return e.jsxs("pixiContainer",{x:o,y:S,"data-testid":"menu-section",children:[e.jsx("pixiGraphics",{draw:h=>{h.clear(),h.beginFill(t.UI_BACKGROUND_DARK,.9),h.drawRoundedRect(0,0,p,s,8),h.endFill(),h.setStrokeStyle({width:2,color:t.PRIMARY_CYAN,alpha:.7}),h.drawRoundedRect(0,0,p,s,8)}}),e.jsxs("pixiContainer",{x:20,y:20,"data-testid":"action-buttons",children:[k.map((h,D)=>{const _=h.mode==="training",d=h.mode==="versus";return e.jsxs("pixiContainer",{y:D*60,"data-testid":_?"training-button":d?"combat-button":`${h.mode.toLowerCase()}-button`,children:[e.jsx("pixiGraphics",{draw:w=>{w.clear(),w.beginFill(a===h.mode?t.ACCENT_GOLD:t.UI_BACKGROUND_MEDIUM,.8),w.drawRoundedRect(0,0,p-40,50,5),w.endFill()},interactive:!0,onPointerDown:()=>C(h.mode)}),e.jsx("pixiText",{text:`${h.korean} - ${h.english}`,style:{fontSize:16,fill:t.TEXT_PRIMARY,align:"center"},x:(p-40)/2,y:25,anchor:.5})]},h.mode)}),e.jsxs("pixiContainer",{y:k.length*60+20,"data-testid":"start-game-button",children:[e.jsx("pixiGraphics",{draw:h=>{h.clear(),h.beginFill(t.POSITIVE_GREEN,.8),h.drawRoundedRect(0,0,p-40,50,5),h.endFill()},interactive:!0,onPointerDown:j}),e.jsx("pixiText",{text:"게임 시작 - Start Game",style:{fontSize:16,fill:t.TEXT_PRIMARY,align:"center"},x:(p-40)/2,y:25,anchor:.5})]})]}),e.jsxs("pixiContainer",{x:20,y:s-80,"data-testid":"archetype-section",children:[e.jsxs("pixiContainer",{"data-testid":"archetype-toggle",children:[e.jsx("pixiGraphics",{draw:h=>{h.clear(),h.beginFill(t.UI_BACKGROUND_MEDIUM,.6),h.drawRoundedRect(0,0,p-40,30,3),h.endFill()},interactive:!0,onPointerDown:T}),e.jsx("pixiText",{text:"무사 선택 - Select Archetype ▼",style:{fontSize:12,fill:t.TEXT_SECONDARY,align:"center"},x:(p-40)/2,y:15,anchor:.5})]}),e.jsx("pixiContainer",{y:35,"data-testid":"archetype-list",alpha:0,children:["musa","amsalja","hacker","jeongbo_yowon","jojik_pokryeokbae"].map((h,D)=>e.jsxs("pixiContainer",{y:D*25,"data-testid":`archetype-option-${h}`,children:[e.jsx("pixiGraphics",{draw:_=>{_.clear(),_.beginFill(t.UI_BACKGROUND_LIGHT,.8),_.drawRoundedRect(0,0,p-40,20,2),_.endFill()}}),e.jsx("pixiText",{text:h,style:{fontSize:10,fill:t.TEXT_SECONDARY},x:5,y:10,anchor:{x:0,y:.5}})]},h))}),e.jsx("pixiContainer",{y:-30,"data-testid":"selected-archetype",children:e.jsx("pixiText",{text:"선택된 무사: 무사",style:{fontSize:10,fill:t.ACCENT_GOLD}})})]}),e.jsxs("pixiContainer",{x:20,y:s-100,"data-testid":"philosophy-button",children:[e.jsx("pixiGraphics",{draw:h=>{h.clear(),h.beginFill(t.UI_BACKGROUND_MEDIUM,.6),h.drawRoundedRect(0,0,100,35,5),h.endFill()},interactive:!0,onPointerDown:n}),e.jsx("pixiText",{text:"철학 - Philosophy",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:50,y:17.5,anchor:.5})]}),e.jsxs("pixiContainer",{x:130,y:s-100,"data-testid":"controls-button",children:[e.jsx("pixiGraphics",{draw:h=>{h.clear(),h.beginFill(t.UI_BACKGROUND_MEDIUM,.6),h.drawRoundedRect(0,0,100,35,5),h.endFill()},interactive:!0,onPointerDown:l}),e.jsx("pixiText",{text:"조작 - Controls",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:50,y:17.5,anchor:.5})]})]})},fe=({title:a,subtitle:C,size:j="medium",alignment:n="center",x:l=0,y:p=0,width:s=400,height:o=80})=>{Y();const k={small:{titleSize:18,subtitleSize:12,spacing:25},medium:{titleSize:24,subtitleSize:16,spacing:35},large:{titleSize:32,subtitleSize:20,spacing:45}}[j],T=n==="center"?.5:n==="right"?1:0,h=n==="center"?s/2:n==="right"?s:0;return e.jsxs("pixiContainer",{x:l,y:p,"data-testid":"korean-header",children:[e.jsx("pixiText",{text:a.korean,style:{fontSize:k.titleSize,fill:t.ACCENT_GOLD,fontWeight:"bold",align:n},x:h,y:0,anchor:{x:T,y:0}}),e.jsx("pixiText",{text:a.english,style:{fontSize:k.titleSize*.8,fill:t.TEXT_SECONDARY,align:n},x:h,y:k.titleSize+5,anchor:{x:T,y:0}}),C&&e.jsxs(e.Fragment,{children:[e.jsx("pixiText",{text:C.korean,style:{fontSize:k.subtitleSize,fill:t.TEXT_PRIMARY,align:n},x:h,y:k.spacing+10,anchor:{x:T,y:0}}),e.jsx("pixiText",{text:C.english,style:{fontSize:k.subtitleSize*.9,fill:t.TEXT_TERTIARY,align:n},x:h,y:k.spacing+10+k.subtitleSize+3,anchor:{x:T,y:0}})]}),e.jsx("pixiGraphics",{draw:D=>{D.clear(),D.lineStyle(2,t.ACCENT_GOLD,.7);const _=o-10,d=s*.6,w=n==="center"?(s-d)/2:0;D.moveTo(w,_),D.lineTo(w+d,_)}})]})},Ce=x.lazy(()=>H(()=>import("./PhilosophySection-C_EzlL.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),Te=x.lazy(()=>H(()=>import("./ControlsSection-CzofwS.js"),__vite__mapDeps([6,1,2,7,4,3,5,8]),import.meta.url));function Se(){const[a,C]=x.useState({width:window.innerWidth,height:window.innerHeight});return x.useEffect(()=>{const j=()=>C({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]),a}const z=[{mode:O.VERSUS,korean:"대전",english:"Versus"},{mode:O.TRAINING,korean:"훈련",english:"Training"},{mode:O.PRACTICE,korean:"연습",english:"Practice"}],Z=({onMenuSelect:a,width:C,height:j})=>{const n=he(),l=x.useRef(!1),[p,s]=x.useState("menu"),[o,S]=x.useState(null),[k,T]=x.useState(null),[h,D]=x.useState(null),[_,d]=x.useState({overview:null,explained:null,dynamics:null}),[w,g]=x.useState(0),[v,r]=x.useState(0),{width:m,height:c}=Se(),y=C??m,R=j??c;x.useEffect(()=>{let i=!1;S(ce.from("/assets/visual/bg/intro/intro_bg_loop_low.webp"));const A=async()=>{try{const E=window?.navigator?.userAgent.includes("Safari")?"/assets/visual/bg/intro/intro_bg_loop.png":"/assets/visual/bg/intro/intro_bg_loop.webp",[I,X,ae,re,oe,se]=await Promise.all([U.load(E),U.load("/src/assets/visual/logo/black-trigram.png"),U.load("/src/assets/dojang_wall_neon_flicker.png"),U.load("/src/assets/visual/bg/archetyples/PlayerArchetypesOverview.png"),U.load("/src/assets/visual/bg/archetyples/PlayerArchetypesExplained.png"),U.load("/src/assets/visual/bg/archetyples/CyberpunkTeamDynamics.png")]);if(i)return;S(I),T(X),D(ae),d({overview:re,explained:oe,dynamics:se})}catch{}};return"requestIdleCallback"in window?window.requestIdleCallback(A):setTimeout(A,100),()=>{i=!0}},[]),x.useEffect(()=>{const i=()=>{n.isInitialized&&!l.current&&(l.current=!0,n.playMusic("intro_theme")),window.removeEventListener("keydown",i),window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",i)};return window.addEventListener("keydown",i,{once:!0}),window.addEventListener("mousedown",i,{once:!0}),window.addEventListener("touchstart",i,{once:!0}),()=>{window.removeEventListener("keydown",i),window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",i),n.stopMusic()}},[n.isInitialized,n]),x.useEffect(()=>{const i=A=>{if(p!=="menu"&&A.key==="Escape"){s("menu"),n.playSFX("menu_back");return}if(p==="menu")if(A.key==="ArrowUp")r(E=>{const I=E===0?z.length-1:E-1;return n.playSFX("menu_hover"),I});else if(A.key==="ArrowDown")r(E=>{const I=E===z.length-1?0:E+1;return n.playSFX("menu_hover"),I});else if(A.key===" "||A.key==="Enter")n.playSFX("menu_select"),a(z[v].mode);else switch(A.key){case"1":r(0),n.playSFX("menu_hover"),n.playSFX("menu_select"),a(O.VERSUS);break;case"2":r(1),n.playSFX("menu_hover"),n.playSFX("menu_select"),a(O.TRAINING);break;case"3":r(2),n.playSFX("menu_hover"),n.playSFX("menu_select"),a(O.PRACTICE);break;case"F1":s("controls"),n.playSFX("menu_select");break;case"4":s("philosophy"),n.playSFX("menu_select");break}};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[a,p,n,v]);const u=x.useCallback(i=>{const A=z.findIndex(E=>E.mode===i);r(A>=0?A:0),n.playSFX("menu_select"),a(i)},[a,n]),N=x.useCallback(()=>{s("philosophy"),n.playSFX("menu_select")},[n]),M=x.useCallback(()=>{s("controls"),n.playSFX("menu_select")},[n]),P=x.useCallback(()=>{s("menu"),n.playSFX("menu_back")},[n]),f=y<768,G=y>=768&&y<1024,b=f?Math.min(y,R)*.35:G?Math.min(y,R)*.25:Math.min(y,R)*.2,F=R*(f?.65:G?.6:.55),q=x.useCallback(i=>{i.clear();const A=new ie(0,0,y,R);A.addColorStop(0,657935),A.addColorStop(.5,1710638),A.addColorStop(1,986915),i.fill(A),i.rect(0,0,y,R),i.fill(),i.stroke({width:1,color:t.PRIMARY_CYAN,alpha:.15});const E=f?30:40;for(let I=0;I<y;I+=E)i.moveTo(I,0),i.lineTo(I,R);for(let I=0;I<R;I+=E)i.moveTo(0,I),i.lineTo(y,I);i.stroke(),i.stroke({width:2,color:t.ACCENT_GOLD,alpha:.3}),i.moveTo(0,R*.2),i.lineTo(y,R*.2),i.moveTo(0,R*.8),i.lineTo(y,R*.8),i.stroke()},[y,R,f]);return e.jsxs("pixiContainer",{width:y,height:R,"data-testid":"intro-screen",children:[e.jsx("pixiGraphics",{draw:q,"data-testid":"intro-background"}),o&&e.jsx("pixiSprite",{texture:o,x:0,y:0,width:y,height:R,alpha:.4,"data-testid":"intro-bg-texture"}),p==="menu"&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{selectedMode:z[v].mode,onModeSelect:u,onStartGame:()=>u(z[v].mode),onShowPhilosophy:N,onShowControls:M,width:f?y*.9:G?y*.7:480,height:f?R*.25:R*.3,x:y/2-(f?y*.45:G?y*.35:240),y:F,menuItems:z,"data-testid":"main-menu-section"}),e.jsx("pixiContainer",{x:y/2,y:R*.6,"data-testid":"interactive-menu",children:z.map((i,A)=>e.jsxs("pixiContainer",{y:A*(f?50:60),"data-testid":`menu-item-${i.mode}`,children:[e.jsx("pixiGraphics",{draw:E=>{E.clear();const I=v===A;E.fill({color:I?t.ACCENT_GOLD:t.UI_BACKGROUND_MEDIUM,alpha:.9}),E.roundRect(-(f?120:150),-20,f?240:300,40,8),E.fill(),E.stroke({width:2,color:I?t.PRIMARY_CYAN:t.ACCENT_GOLD,alpha:.8}),E.roundRect(-(f?120:150),-20,f?240:300,40,8),E.stroke()},interactive:!0,onPointerDown:()=>u(i.mode),"data-testid":`menu-button-${i.mode}`}),e.jsx("pixiText",{text:`${i.korean} - ${i.english}`,style:{fontSize:f?14:18,fill:v===A?t.BLACK_SOLID:t.TEXT_PRIMARY,align:"center",fontWeight:v===A?"bold":"normal"},anchor:.5,"data-testid":`menu-text-${i.mode}`})]},i.mode))})]}),h&&e.jsx("pixiSprite",{texture:h,x:y*.8,y:0,width:y*.3,height:R,alpha:.2,"data-testid":"dojang-wall-accent"}),e.jsxs("pixiContainer",{x:y/2,y:R*(f?.25:.3),"data-testid":"logo-section",children:[k&&e.jsx("pixiSprite",{texture:k,x:0,y:0,scale:{x:b/512,y:b/512},anchor:{x:.5,y:.5},alpha:1,"data-testid":"main-logo"}),e.jsx("pixiGraphics",{draw:i=>{i.clear(),i.circle(0,0,b*.6),i.fill({color:t.PRIMARY_CYAN,alpha:.1}),i.circle(0,0,b*.8),i.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6})},"data-testid":"logo-glow-effect"}),e.jsx("pixiContainer",{y:b*.7,"data-testid":"trigram-symbols",children:e.jsx("pixiText",{text:"☰ ☱ ☲ ☳ ☴ ☵ ☶ ☷",style:{fontSize:f?20:28,fill:t.PRIMARY_CYAN,align:"center",letterSpacing:f?8:12},anchor:.5,"data-testid":"trigram-symbols-text"})})]}),e.jsx(fe,{title:{korean:"흑괘",english:"Black Trigram"},subtitle:{korean:"한국 무술 시뮬레이터",english:"Korean Martial Arts Simulator"},align:"center",x:y/2,y:R*(f?.45:.48),"data-testid":"main-title"}),p==="menu"&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{selectedMode:z[v].mode,onModeSelect:u,onStartGame:()=>u(z[v].mode),onShowPhilosophy:N,onShowControls:M,width:f?y*.9:G?y*.7:480,height:f?R*.25:R*.3,x:y/2-(f?y*.45:G?y*.35:240),y:F,menuItems:z,"data-testid":"main-menu-section"}),e.jsxs("pixiContainer",{x:f?20:40,y:R-(f?220:250),"data-testid":"archetype-selection",children:[e.jsxs("pixiContainer",{"data-testid":"archetype-toggle",children:[e.jsx("pixiGraphics",{draw:i=>{i.clear(),i.fill({color:t.UI_BACKGROUND_MEDIUM,alpha:.9}),i.roundRect(0,0,f?140:180,45,8),i.fill(),i.stroke({width:2,color:t.ACCENT_GOLD,alpha:.8}),i.roundRect(0,0,f?140:180,45,8),i.stroke()},interactive:!0,onPointerDown:()=>{n.playSFX("menu_hover"),g(i=>(i+1)%5)},"data-testid":"archetype-toggle-button"}),e.jsx("pixiText",{text:"무사 유형 선택",style:{fontSize:f?12:14,fill:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:(f?140:180)/2,y:22,anchor:.5,"data-testid":"archetype-toggle-text"})]}),e.jsx("pixiContainer",{y:55,"data-testid":"archetype-list",children:[{id:"musa",korean:"무사",english:"Warrior",color:t.TRIGRAM_GEON_PRIMARY},{id:"amsalja",korean:"암살자",english:"Assassin",color:t.TRIGRAM_SON_PRIMARY},{id:"hacker",korean:"해커",english:"Hacker",color:t.PRIMARY_CYAN},{id:"jeongbo_yowon",korean:"정보요원",english:"Agent",color:t.TRIGRAM_TAE_PRIMARY},{id:"jojik_pokryeokbae",korean:"조직폭력배",english:"Gangster",color:t.TRIGRAM_JIN_PRIMARY}].map((i,A)=>e.jsxs("pixiContainer",{y:A*(f?32:38),"data-testid":`archetype-option-${i.id}`,children:[e.jsx("pixiGraphics",{draw:E=>{E.clear(),E.fill({color:w===A?t.ACCENT_GOLD:t.UI_BACKGROUND_LIGHT,alpha:.8}),E.roundRect(0,0,f?160:200,f?28:32,4),E.fill(),E.stroke({width:1,color:i.color,alpha:.8}),E.roundRect(0,0,f?160:200,f?28:32,4),E.stroke()},interactive:!0,onPointerDown:()=>{g(A),n.playSFX("menu_select")},"data-testid":`archetype-option-${i.id}-button`}),e.jsx("pixiGraphics",{draw:E=>{E.clear(),E.fill({color:i.color,alpha:.8}),E.circle(12,(f?28:32)/2,6),E.fill()},"data-testid":`archetype-icon-${i.id}`}),e.jsx("pixiText",{text:`${i.korean} - ${i.english}`,style:{fontSize:f?10:12,fill:w===A?t.BLACK_SOLID:t.TEXT_PRIMARY,fontWeight:w===A?"bold":"normal"},x:25,y:(f?28:32)/2,anchor:{x:0,y:.5},"data-testid":`archetype-text-${i.id}`})]},i.id))}),e.jsxs("pixiContainer",{y:f?180:210,"data-testid":"selected-archetype",children:[e.jsx("pixiGraphics",{draw:i=>{i.clear(),i.fill({color:t.ACCENT_GOLD,alpha:.2}),i.roundRect(0,0,f?160:200,40,6),i.fill()}}),e.jsx("pixiText",{text:"선택된 무사 유형",style:{fontSize:f?10:12,fill:t.TEXT_SECONDARY},x:8,y:8,"data-testid":"selected-archetype-label"}),e.jsx("pixiText",{text:["무사","암살자","해커","정보요원","조직폭력배"][w],style:{fontSize:f?12:14,fill:t.ACCENT_GOLD,fontWeight:"bold"},x:8,y:22,"data-testid":"selected-archetype-value"})]})]}),e.jsx("pixiContainer",{x:y-(f?y*.95:G?350:400),y:R/2-(f?100:150),"data-testid":"archetype-display",children:!f&&e.jsxs(e.Fragment,{children:[e.jsx("pixiText",{text:"무사 유형 가이드",style:{fontSize:G?16:18,fill:t.ACCENT_GOLD,fontWeight:"bold"},y:-35,"data-testid":"archetype-display-title"}),Object.values(_).filter(Boolean).length>0&&e.jsx("pixiSprite",{texture:Object.values(_).filter(Boolean)[w%Object.values(_).filter(Boolean).length],width:G?280:320,height:G?200:240,interactive:!0,onPointerDown:()=>{g(i=>(i+1)%5),n.playSFX("menu_hover")},"data-testid":"archetype-display-image"}),e.jsx("pixiText",{text:`${w+1} / 5`,style:{fontSize:14,fill:t.TEXT_SECONDARY,align:"center"},x:(G?280:320)/2,y:G?220:260,anchor:.5,"data-testid":"archetype-display-counter"})]})})]}),p==="philosophy"&&e.jsx(x.Suspense,{fallback:e.jsx("pixiText",{text:"로딩 중..."}),children:e.jsx(Ce,{onBack:P,width:y*.9,height:R*.8,x:y*.05,y:R*.1,"data-testid":"philosophy-section"})}),p==="controls"&&e.jsx(x.Suspense,{fallback:e.jsx("pixiText",{text:"로딩 중..."}),children:e.jsx(Te,{onBack:P,width:y*.9,height:R*.8,x:y*.05,y:R*.1,"data-testid":"controls-section"})}),e.jsxs("pixiContainer",{x:y/2,y:R-(f?60:80),"data-testid":"intro-footer",children:[e.jsx("pixiText",{text:"흑괘의 길을 걸어라 - Walk the Path of the Black Trigram",style:{fontSize:f?10:14,fill:t.ACCENT_CYAN,align:"center",fontStyle:"italic"},x:0,y:f?-30:-35,anchor:.5,"data-testid":"footer-motto"}),e.jsx("pixiText",{text:"Open Source Korean Martial Arts Game by Hack23",style:{fontSize:f?9:12,fill:t.SECONDARY_MAGENTA,align:"center",fontWeight:"bold"},interactive:!0,onPointerTap:()=>window.open("https://github.com/Hack23/blacktrigram","_blank"),x:0,y:f?-15:-18,anchor:.5,"data-testid":"footer-link"})]})]})},Re=({player:a,x:C,y:j,onClick:n})=>(Y(),e.jsxs("pixiContainer",{x:C,y:j,"data-testid":"player",children:[e.jsx("pixiGraphics",{draw:l=>{l.clear(),l.fill({color:t.PRIMARY_CYAN,alpha:.8}),l.rect(-30,-60,60,120),l.fill()},interactive:!0,onPointerDown:n}),e.jsx("pixiText",{text:a.name.korean,style:{fontSize:14,fill:t.TEXT_PRIMARY,align:"center"},x:0,y:-80,anchor:.5,children:a.name.korean}),e.jsx("pixiGraphics",{draw:l=>{l.clear();const p=a.health/a.maxHealth;l.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),l.rect(-25,70,50,8),l.fill(),l.fill({color:t.POSITIVE_GREEN,alpha:.9}),l.rect(-25,70,50*p,8),l.fill()}})]})),be=({players:a,onPlayerClick:C,width:j=1200,height:n=800,x:l=0,y:p=0})=>(Y(),e.jsxs("pixiContainer",{x:l,y:p,children:[e.jsx("pixiGraphics",{draw:s=>{s.clear(),s.beginFill(t.ARENA_BACKGROUND,.3),s.drawRect(0,0,j,n),s.endFill(),s.lineStyle(2,t.UI_BORDER,.5),s.moveTo(j/2,0),s.lineTo(j/2,n)}}),a.map((s,o)=>e.jsx(Re,{player:s,x:o===0?j*.25:j*.75,y:n*.7,onClick:()=>C?.(o)},s.id)),e.jsx("pixiGraphics",{draw:s=>{s.clear(),s.lineStyle(3,t.ACCENT_GOLD,.8),s.drawRect(50,100,j-100,n-200)}}),[[75,125],[j-75,125],[75,n-125],[j-75,n-125]].map(([s,o],S)=>e.jsx("pixiGraphics",{draw:k=>{k.clear(),k.beginFill(t.ACCENT_GOLD,.6),k.drawCircle(s,o,8),k.endFill()}},S))]})),Ae=({onAttack:a,onDefend:C,onSwitchStance:j,player:n,onTechniqueExecute:l,isExecutingTechnique:p=!1,width:s=300,height:o=100,x:S=0,y:k=0})=>{Y();const T=n?xe[n.currentStance]:void 0,h=x.useMemo(()=>{if(!T?.techniques?.primary)return[];const d=T.techniques.primary;return[{id:`${n.currentStance}_primary`,name:{korean:d.korean,english:d.english,romanized:d.korean},koreanName:d.korean,englishName:d.english,romanized:d.korean,description:d.description,stance:n.currentStance,type:"strike",damageType:pe.BLUNT,damage:d.damage,damageRange:{min:d.damage-5,max:d.damage+5},range:1,kiCost:d.kiCost,staminaCost:d.staminaCost,accuracy:d.hitChance,executionTime:500,recoveryTime:800,critChance:d.criticalChance,critMultiplier:1.5,effects:[]}]},[T,n.currentStance]),D=x.useCallback(d=>{l?.(d)},[l]),_=x.useCallback(d=>{d.clear(),d.beginFill(t.UI_BACKGROUND_DARK,.9),d.lineStyle(2,t.PRIMARY_CYAN,.8),d.drawRoundedRect(0,0,s,o,10),d.endFill()},[s,o]);return e.jsxs("pixiContainer",{x:S,y:k,"data-testid":"combat-controls",children:[e.jsx("pixiGraphics",{draw:_}),e.jsxs("pixiContainer",{x:10,y:10,children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.beginFill(t.ACCENT_RED,.8),d.drawRoundedRect(0,0,60,30,5),d.endFill()},interactive:!0,onPointerDown:a}),e.jsx("pixiText",{text:"공격",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:30,y:15,anchor:.5})]}),e.jsxs("pixiContainer",{x:80,y:10,children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.beginFill(t.ACCENT_BLUE,.8),d.drawRoundedRect(0,0,60,30,5),d.endFill()},interactive:!0,onPointerDown:C}),e.jsx("pixiText",{text:"방어",style:{fontSize:12,fill:t.TEXT_PRIMARY,align:"center"},x:30,y:15,anchor:.5})]}),h.length>0&&e.jsxs("pixiContainer",{x:150,y:10,children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.beginFill(t.ACCENT_GOLD,.8),d.drawRoundedRect(0,0,80,30,5),d.endFill()},interactive:!0,onPointerDown:()=>D(h[0])}),e.jsx("pixiText",{text:h[0].name.korean,style:{fontSize:10,fill:t.BLACK_SOLID,align:"center"},x:40,y:15,anchor:.5})]}),e.jsx("pixiContainer",{x:10,y:50,children:e.jsx("pixiText",{text:`현재 자세: ${T?.name.korean||"없음"}`,style:{fontSize:10,fill:t.TEXT_SECONDARY}})}),j&&e.jsxs("pixiContainer",{x:150,y:50,children:[e.jsx("pixiGraphics",{draw:d=>{d.clear(),d.beginFill(t.ACCENT_CYAN,.8),d.drawRoundedRect(0,0,80,20,3),d.endFill()},interactive:!0,onPointerDown:()=>j(n.currentStance)}),e.jsx("pixiText",{text:"자세 변경",style:{fontSize:8,fill:t.BLACK_SOLID,align:"center"},x:40,y:10,anchor:.5})]}),p&&e.jsx("pixiContainer",{x:s/2,y:o/2,children:e.jsx("pixiText",{text:"기술 실행 중...",style:{fontSize:12,fill:t.WARNING_YELLOW,align:"center"},anchor:.5})})]})},ee=({current:a,max:C,playerName:j,position:n="left",x:l,y:p,width:s,height:o,screenWidth:S,screenHeight:k,showText:T=!0,animated:h=!0,showDamageIndicator:D=!0})=>{const _=S<768,{healthPercentage:d,healthStatus:w,displayHealth:g}=x.useMemo(()=>{const u=C>0?a/C:0;let N="high";return u<=.15?N="critical":u<=.35?N="low":u<=.65&&(N="medium"),{healthPercentage:Math.max(0,Math.min(1,u)),healthStatus:N,displayHealth:Math.max(0,a)}},[a,C]),v=()=>{switch(w){case"critical":return t.ACCENT_RED;case"low":return t.ACCENT_GOLD;case"medium":return t.ACCENT_CYAN;default:return t.ACCENT_GREEN}},r=()=>d>.5?[t.ACCENT_GREEN,t.ACCENT_CYAN]:d>.25?[t.ACCENT_GOLD,t.ACCENT_GREEN]:[t.ACCENT_RED,t.ACCENT_GOLD],m=n==="right",c=n==="center",y=h?Math.sin(Date.now()*.005)*.1+.9:1,R=D&&w==="critical"?Math.sin(Date.now()*.01)*.3+.7:1;return e.jsxs(W,{x:l,y:p,screenWidth:S,screenHeight:k,"data-testid":`health-bar-${n}`,children:[T&&e.jsx("pixiText",{text:j,style:{fontSize:_?12:14,fill:t.TEXT_PRIMARY,fontWeight:"bold",fontFamily:"Noto Sans KR",align:m?"right":c?"center":"left",dropShadow:{color:t.BLACK_SOLID,blur:2,distance:2}},x:m?s:c?s/2:0,y:0,anchor:m?{x:1,y:0}:c?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-name-${n}`}),e.jsxs("pixiContainer",{x:0,y:T?_?20:25:5,"data-testid":`health-bar-container-${n}`,children:[e.jsx("pixiGraphics",{draw:u=>{u.clear();const N=o-(T?_?25:30:5);u.fill({color:t.UI_BACKGROUND_DARK,alpha:.9}),u.roundRect(0,0,s,N,4),u.fill(),u.stroke({width:1,color:t.ACCENT_GOLD,alpha:.3});for(let M=0;M<s;M+=20)u.moveTo(M,0),u.lineTo(M+10,N/2),u.lineTo(M,N);u.stroke(),u.stroke({width:2,color:t.ACCENT_GOLD,alpha:.8}),u.roundRect(0,0,s,N,4),u.stroke()},"data-testid":`health-bar-background-${n}`}),e.jsx("pixiGraphics",{draw:u=>{u.clear();const N=o-(T?_?25:30:5),M=s*d;if(M>0){const[P,f]=r(),G=new ie(0,0,M,0);G.addColorStop(0,P),G.addColorStop(1,f),u.fill(G),m?u.roundRect(s-M,0,M,N,4):u.roundRect(0,0,M,N,4),u.fill(),u.fill({color:16777215,alpha:.3*(h?y:1)});const b=M*.6,F=N*.4;m?u.roundRect(s-b-4,2,b,F,2):u.roundRect(4,2,b,F,2),u.fill()}},"data-testid":`health-bar-fill-${n}`}),D&&w==="critical"&&e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.stroke({width:3,color:t.ACCENT_RED,alpha:.8*R}),u.roundRect(-3,-3,s+6,o-(T?_?21:26:1),7),u.stroke(),u.fill({color:t.ACCENT_RED,alpha:.1*R}),u.roundRect(0,0,s,o-(T?_?25:30:5),4),u.fill()},"data-testid":`health-bar-critical-effect-${n}`}),e.jsx("pixiGraphics",{draw:u=>{u.clear();const N=o-(T?_?25:30:5);u.stroke({width:1,color:t.ACCENT_GOLD,alpha:.4});const M=4,P=s/M;for(let f=1;f<M;f++){const G=P*f;u.moveTo(G,2),u.lineTo(G,N-2),u.circle(G,N/2,2)}u.stroke()},"data-testid":`health-bar-segments-${n}`})]}),T&&e.jsx("pixiText",{text:`${Math.ceil(g)} / ${C}`,style:{fontSize:_?10:12,fill:v(),fontWeight:"bold",align:m?"right":c?"center":"left",dropShadow:{color:t.BLACK_SOLID,blur:1,distance:1}},x:m?s:c?s/2:0,y:o-(_?12:15),anchor:m?{x:1,y:0}:c?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-text-${n}`}),T&&e.jsx("pixiText",{text:w==="critical"?"위험 - 기절 직전":w==="low"?"부상 - 약한 상태":w==="medium"?"보통 - 전투 가능":"건강 - 최상 컨디션",style:{fontSize:_?7:9,fill:t.TEXT_SECONDARY,fontFamily:"Noto Sans KR",align:m?"right":c?"center":"left",fontStyle:"italic"},x:m?s-2:c?s/2:2,y:T?_?22:27:7,anchor:m?{x:1,y:0}:c?{x:.5,y:0}:{x:0,y:0},"data-testid":`health-bar-status-${n}`}),d>.8&&h&&e.jsx("pixiGraphics",{draw:u=>{u.clear(),u.fill({color:t.ACCENT_GREEN,alpha:.3*Math.sin(Date.now()*.008)+.3}),u.circle(m?s-10:10,(T?_?22:27:7)+5,3),u.fill()},"data-testid":`health-bar-ki-indicator-${n}`})]})},Ee=({timeRemaining:a,totalTime:C,currentRound:j,maxRounds:n,isPaused:l=!1,x:p,y:s,width:o,height:S,screenWidth:k,screenHeight:T,showMilliseconds:h=!1})=>{const D=k<768,{minutes:_,seconds:d,milliseconds:w,timePercentage:g,urgencyLevel:v}=x.useMemo(()=>{const c=Math.floor(a/60),y=Math.floor(a%60),R=Math.floor(a%1*100),u=C>0?a/C:0;let N="normal";return u<.1?N="critical":u<.3&&(N="warning"),{minutes:c,seconds:y,milliseconds:R,timePercentage:u,urgencyLevel:N}},[a,C]),r=()=>{if(l)return t.TEXT_SECONDARY;switch(v){case"critical":return t.ACCENT_RED;case"warning":return t.ACCENT_GOLD;default:return t.ACCENT_GREEN}},m=()=>{const c=`${_.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`;return h?`${c}.${w.toString().padStart(2,"0")}`:c};return e.jsxs(W,{x:p,y:s,screenWidth:k,screenHeight:T,"data-testid":"round-timer",children:[e.jsx($,{title:"",x:0,y:0,width:o,height:S,screenWidth:k,screenHeight:T}),e.jsx("pixiContainer",{x:o/2,y:15,"data-testid":"round-info",children:e.jsx("pixiText",{text:`라운드 ${j} / ${n}`,style:{fontSize:D?12:14,fill:t.TEXT_PRIMARY,fontWeight:"bold",align:"center",fontFamily:"Noto Sans KR"},anchor:.5,"data-testid":"round-counter"})}),e.jsxs("pixiContainer",{x:o/2,y:S/2,"data-testid":"timer-display",children:[e.jsx("pixiGraphics",{draw:c=>{c.clear();const y=D?35:45;c.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),c.circle(0,0,y),c.fill(),c.stroke({width:4,color:r(),alpha:.9});const R=g*Math.PI*2;c.arc(0,0,y-2,-Math.PI/2,-Math.PI/2+R),c.stroke(),c.stroke({width:2,color:t.ACCENT_GOLD,alpha:.6}),c.circle(0,0,y),c.stroke()},"data-testid":"timer-circle"}),e.jsx("pixiText",{text:m(),style:{fontSize:D?14:18,fill:r(),fontWeight:"bold",align:"center",fontFamily:"monospace"},anchor:.5,"data-testid":"timer-text"}),l&&e.jsx("pixiText",{text:"일시정지",style:{fontSize:D?8:10,fill:t.TEXT_SECONDARY,align:"center",fontFamily:"Noto Sans KR"},x:0,y:D?20:25,anchor:.5,"data-testid":"pause-indicator"})]}),e.jsx("pixiGraphics",{draw:c=>{c.clear();const y=o-20,R=4,u=S-15;c.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),c.rect(10,u,y,R),c.fill();const N=y*g;c.fill({color:r(),alpha:.9}),c.rect(10,u,N,R),c.fill(),c.stroke({width:1,color:t.ACCENT_GOLD,alpha:.6}),c.rect(10,u,y,R),c.stroke()},"data-testid":"timer-progress-bar"}),v==="critical"&&!l&&e.jsx("pixiGraphics",{draw:c=>{c.clear();const y=Math.sin(Date.now()*.01)*.3+.7;c.stroke({width:3,color:t.ACCENT_RED,alpha:y}),c.rect(2,2,o-4,S-4),c.stroke()},"data-testid":"critical-timer-effect"}),e.jsx("pixiContainer",{x:o/2,y:S-30,"data-testid":"time-label",children:e.jsx("pixiText",{text:"남은 시간",style:{fontSize:D?9:11,fill:t.TEXT_TERTIARY,align:"center",fontFamily:"Noto Sans KR"},anchor:.5,"data-testid":"time-label-korean"})})]})},_e=({player1:a,player2:C,timeRemaining:j,currentRound:n,maxRounds:l,isPaused:p,onPauseToggle:s,width:o=1200,height:S=120,x:k=0,y:T=0})=>{Y();const h=o<768,D=h?180:250,_=h?140:160,d=o/2,w=x.useCallback(r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_DARK,.95),r.drawRect(0,0,o,S),r.endFill(),r.lineStyle(3,t.ACCENT_GOLD,.8),r.drawRect(5,5,o-10,S-10),r.lineStyle(2,t.PRIMARY_CYAN,.6),r.moveTo(o/2,10),r.lineTo(o/2,S-10),r.beginFill(t.ACCENT_GOLD,.3),r.drawCircle(o/2,S/2,25),r.endFill(),r.beginFill(t.UI_BACKGROUND_DARK,.8),r.arc(o/2,S/2,25,0,Math.PI),r.arc(o/2,S/2-12.5,12.5,Math.PI,0,!0),r.arc(o/2,S/2+12.5,12.5,0,Math.PI,!0),r.endFill()},[o,S]),g=V[a.archetype],v=V[C.archetype];return e.jsxs("pixiContainer",{x:k,y:T,"data-testid":"combat-hud",children:[e.jsx("pixiGraphics",{draw:w}),e.jsxs("pixiContainer",{x:20,y:15,children:[e.jsx("pixiText",{text:a.name.korean,style:{fontSize:18,fill:g.colors.primary,fontWeight:"bold"}}),e.jsx("pixiText",{text:g.name.korean,style:{fontSize:12,fill:t.TEXT_SECONDARY},y:20}),e.jsx(ee,{current:a.health,max:a.maxHealth,width:D,height:25,showText:!0,x:20,y:35,position:"left",playerName:a.name.korean,screenWidth:o,screenHeight:S,"data-testid":"player1-health-bar"}),e.jsxs("pixiContainer",{y:70,children:[e.jsx("pixiText",{text:"기력",style:{fontSize:8,fill:t.TEXT_SECONDARY}}),e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_MEDIUM,.8),r.drawRect(25,0,100,8),r.endFill(),r.beginFill(t.PRIMARY_CYAN,.9),r.drawRect(25,0,100*(a.ki/a.maxKi),8),r.endFill()}}),e.jsx("pixiText",{text:"체력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:135}),e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_MEDIUM,.8),r.drawRect(160,0,100,8),r.endFill(),r.beginFill(t.SECONDARY_YELLOW,.9),r.drawRect(160,0,100*(a.stamina/a.maxStamina),8),r.endFill()}})]}),e.jsx(J,{stance:a.currentStance,x:20,y:60,size:40,"data-testid":"player1-stance-indicator"})]}),e.jsxs("pixiContainer",{x:d-_/2,y:20,children:[e.jsx(Ee,{currentRound:n,maxRounds:l,timeRemaining:j,totalTime:180,width:_,height:35,x:0,y:0,isPaused:p,screenWidth:o,screenHeight:S,"data-testid":"round-timer"}),e.jsx("pixiText",{text:`라운드 ${n}/${l}`,style:{fontSize:14,fill:t.ACCENT_GOLD,align:"center",fontWeight:"bold"},x:80,y:45,anchor:.5}),Array.from({length:l},(r,m)=>e.jsx("pixiGraphics",{draw:c=>{c.clear();const y=m<n;c.beginFill(y?t.ACCENT_GOLD:t.UI_GRAY,.8),c.drawCircle(40+m*20,65,6),c.endFill()}},m))]}),e.jsxs("pixiContainer",{x:o-320,y:15,children:[e.jsx("pixiText",{text:C.name.korean,style:{fontSize:18,fill:v.colors.primary,fontWeight:"bold",align:"right"},x:280,anchor:{x:1,y:0}}),e.jsx("pixiText",{text:v.name.korean,style:{fontSize:12,fill:t.TEXT_SECONDARY,align:"right"},x:280,y:20,anchor:{x:1,y:0}}),e.jsx(ee,{current:C.health,max:C.maxHealth,width:D,height:25,showText:!0,x:o-D-20,y:35,position:"right",playerName:C.name.korean,screenWidth:o,screenHeight:S,"data-testid":"player2-health-bar"}),e.jsxs("pixiContainer",{y:70,children:[e.jsx("pixiText",{text:"기력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:30}),e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_MEDIUM,.8),r.drawRect(55,0,100,8),r.endFill(),r.beginFill(t.PRIMARY_CYAN,.9),r.drawRect(55,0,100*(C.ki/C.maxKi),8),r.endFill()}}),e.jsx("pixiText",{text:"체력",style:{fontSize:8,fill:t.TEXT_SECONDARY},x:165}),e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_MEDIUM,.8),r.drawRect(190,0,100,8),r.endFill(),r.beginFill(t.SECONDARY_YELLOW,.9),r.drawRect(190,0,100*(C.stamina/C.maxStamina),8),r.endFill()}})]}),e.jsx(J,{stance:C.currentStance,x:o-60,y:60,size:40,"data-testid":"player2-stance-indicator"})]}),s&&e.jsxs("pixiContainer",{x:o-80,y:S-40,children:[e.jsx("pixiGraphics",{draw:r=>{r.clear(),r.beginFill(t.UI_BACKGROUND_MEDIUM,.9),r.lineStyle(2,t.ACCENT_GOLD,.8),r.drawRoundedRect(0,0,60,30,5),r.endFill()},interactive:!0,onPointerDown:s}),e.jsx("pixiText",{text:p?"계속":"정지",style:{fontSize:10,fill:t.TEXT_PRIMARY,align:"center",fontWeight:"bold"},x:30,y:15,anchor:.5})]})]})},je=({effects:a,onEffectComplete:C})=>{Y();const[j,n]=x.useState([]);return x.useEffect(()=>{const l=a.map(p=>({...p,opacity:Math.max(0,1-(Date.now()-p.timestamp)/p.duration),scale:1+(Date.now()-p.timestamp)/p.duration*.5,startTime:p.timestamp,displayAlpha:1,displayY:p.position?.y||0,displaySize:1,attackerId:p.attackerId||"unknown",defenderId:p.defenderId||"unknown"}));n(l),a.forEach(p=>{Date.now()-p.timestamp>p.duration&&C(p.id)})},[a,C]),e.jsx("pixiContainer",{"data-testid":"hit-effects-layer",children:j.map(l=>e.jsx("pixiContainer",{x:l.position?.x||0,y:l.displayY,alpha:l.opacity,children:e.jsx("pixiText",{text:l.text||l.type,style:{fontSize:16*l.scale,fill:t.CRITICAL_HIT,fontWeight:"bold",align:"center"},anchor:.5})},l.id))})},te=({player:a,position:C,...j})=>L.createElement("pixiContainer",j,L.createElement("pixiText",{text:`${a.name.korean} - ${C}`,style:{fontSize:14,fill:16777215}})),we=({players:a,combatLog:C,...j})=>L.createElement("pixiContainer",j,L.createElement("pixiText",{text:"Combat Stats",style:{fontSize:16,fill:16766720}}),...(C||[]).slice(0,3).map((n,l)=>L.createElement("pixiText",{key:l,text:n,style:{fontSize:12,fill:13421772},y:20+l*15}))),ke=({players:a,onPlayerUpdate:C,currentRound:j,timeRemaining:n,isPaused:l,onReturnToMenu:p,onGameEnd:s,width:o=1200,height:S=800,x:k=0,y:T=0})=>{const[h,D]=x.useState([]),[_,d]=x.useState(!1),[w,g]=x.useState(null),[v]=x.useState([]),r=x.useCallback((i,A,E,I)=>({id:i,type:A,attackerId:"player1",defenderId:"player2",timestamp:Date.now(),duration:1e3,position:E,intensity:I,startTime:Date.now()}),[]),m=x.useCallback(()=>{const i=r(`attack_${Date.now()}`,"hit",{x:400,y:300},1);D(A=>[...A,i])},[r]),c=x.useCallback(()=>{},[]),y=x.useCallback(i=>{d(!0),setTimeout(()=>d(!1),500)},[]),R=x.useCallback(i=>{d(!0),C(0,{currentStance:i})},[C]),u=x.useCallback(()=>{},[]),N=x.useCallback(()=>{d(!0),setTimeout(()=>d(!1),800)},[]),M=x.useCallback(i=>{D(A=>A.filter(E=>E.id!==i))},[]),P=x.useMemo(()=>{if(a.length<2){const i={...a[0],id:"dummy_player",name:{korean:"더미",english:"Dummy"}};return[a[0],i]}return[a[0],a[1]]},[a]),f=x.useCallback((i,A)=>{const E=r(`effect_${Date.now()}`,i,A,1);D(I=>[...I,E])},[r]),G=x.useCallback(()=>{P[0].health<=0?s(1):P[1].health<=0&&s(0)},[P,s]);L.useEffect(()=>{G()},[G]);const{isMobile:b,isTablet:F}=x.useMemo(()=>{const i=o<768,A=o>=768&&o<1024;return{isMobile:i,isTablet:A}},[o,S]),q=i=>{g(i),f("hit",{x:100+i*200,y:200})};return e.jsxs(W,{x:k,y:T,"data-testid":"combat-screen",children:[e.jsx(ue,{width:o,height:S,lighting:"cyberpunk",animate:!0}),e.jsx("pixiGraphics",{draw:i=>{i.clear(),i.stroke({width:1,color:t.ACCENT_GOLD,alpha:.1});const A=b?100:F?125:150,E=b?25:F?32:40;for(let I=0;I<o;I+=A)for(let X=0;X<S;X+=A)i.circle(I+A/2,X+A/2,E),i.stroke()}}),e.jsx(be,{players:P,width:o,height:S*(b?.65:.75),y:S*(b?.2:.15),onPlayerClick:q}),e.jsx(_e,{player1:P[0],player2:P[1],currentRound:j,timeRemaining:n,maxRounds:3,isPaused:l,width:o,height:b?80:120,y:0}),e.jsx($,{title:P[0].name.korean,x:b?10:20,y:S*(b?.15:.2),width:b?o*.4:180,height:b?200:300,"data-testid":"player1-status",children:e.jsx(te,{player:P[0],position:"left",x:0,y:0,width:b?o*.4-20:160,height:b?180:280,isSelected:w===0})}),e.jsx($,{title:P[1].name.korean,x:o-(b?o*.4+10:200),y:S*(b?.15:.2),width:b?o*.4:180,height:b?200:300,"data-testid":"player2-status",children:e.jsx(te,{player:P[1],position:"right",x:0,y:0,width:b?o*.4-20:160,height:b?180:280,isSelected:w===1})}),e.jsx($,{title:"전투 통계",x:b?10:o/2-150,y:S-(b?160:180),width:b?o-20:300,height:b?100:160,"data-testid":"combat-stats-panel",children:e.jsx(we,{players:P,combatLog:v,x:0,y:0,width:b?o-40:280,height:b?80:140})}),e.jsx(W,{x:b?10:20,y:S-(b?50:140),"data-testid":"combat-controls-container",children:e.jsx(Ae,{onAttack:m,onDefend:c,onSwitchStance:R,onPauseToggle:N,isPaused:l,player:P[0],onTechniqueExecute:y,onGuard:u,isExecutingTechnique:_,width:b?o-20:400,height:b?40:120,x:0,y:0})}),e.jsx(je,{effects:h,onEffectComplete:M}),e.jsx(ye,{text:"메뉴로",x:o-(b?80:150),y:b?10:20,width:b?70:120,height:b?35:45,variant:"secondary",onClick:p,"data-testid":"return-menu-button"}),l&&e.jsxs(W,{x:0,y:0,"data-testid":"pause-overlay",children:[e.jsx("pixiGraphics",{draw:i=>{i.clear(),i.fill({color:t.UI_BACKGROUND_DARK,alpha:.8}),i.rect(0,0,o,S),i.fill()}}),e.jsx("pixiText",{text:"일시 정지",style:{fontSize:b?32:48,fill:t.ACCENT_GOLD,fontWeight:"bold",align:"center"},x:o/2,y:S/2-30,anchor:.5}),e.jsx("pixiText",{text:"PAUSED",style:{fontSize:b?16:24,fill:t.TEXT_SECONDARY,align:"center"},x:o/2,y:S/2+20,anchor:.5})]})]})},De=x.lazy(()=>H(()=>import("./screens-DnjLBe.js").then(a=>a.E),__vite__mapDeps([7,1,2,4,3,5,8]),import.meta.url)),Ne=x.lazy(()=>H(()=>import("./screens-DnjLBe.js").then(a=>a.T),__vite__mapDeps([7,1,2,4,3,5,8]),import.meta.url));function Ie(){Y();const[a,C]=x.useState(null),[j,n]=x.useState(!1),[l,p]=x.useState(null),[s,o]=x.useState(null),[S,k]=x.useState(!1),[T,h]=x.useState({width:window.innerWidth,height:window.innerHeight,isMobile:window.innerWidth<768,isTablet:window.innerWidth>=768&&window.innerWidth<1024,isDesktop:window.innerWidth>=1024}),D=x.useCallback(m=>{m&&typeof window<"u"&&me(m)},[]);x.useEffect(()=>{const c=setInterval(()=>{const y=window.pixiApp;y&&D(y)},100);return setTimeout(()=>clearInterval(c),5e3),()=>clearInterval(c)},[D]),x.useEffect(()=>{(async()=>{try{window.focus(),window.addEventListener("error",c=>{}),window.addEventListener("unhandledrejection",c=>{(c.reason?.message?.includes("Failed to load")||c.reason?.message?.includes("no supported source"))&&c.preventDefault()}),k(!0)}catch{k(!0)}})()},[]);const _=x.useCallback(m=>{C(m),n(!0),p(null),o(null)},[]),d=x.useCallback(m=>{n(!1),p(K(B.MUSA,m)),o({totalDamageDealt:150,totalDamageTaken:100,criticalHits:3,vitalPointHits:2,techniquesUsed:8,perfectStrikes:1,consecutiveWins:1,matchDuration:120,totalMatches:1,maxRounds:3,winner:m,totalRounds:2,currentRound:2,timeRemaining:0,combatEvents:[],finalScore:{player1:m===0?2:0,player2:m===1?2:0},roundsWon:{player1:m===0?2:0,player2:m===1?2:0},player1:{wins:m===0?1:0,losses:m===0?0:1,hitsTaken:5,hitsLanded:8,totalDamageDealt:m===0?150:100,totalDamageReceived:m===0?100:150,techniques:["천둥벽력","유수연타"],perfectStrikes:m===0?1:0,vitalPointHits:m===0?2:1,consecutiveWins:m===0?1:0,matchDuration:120},player2:{wins:m===1?1:0,losses:m===1?0:1,hitsTaken:8,hitsLanded:5,totalDamageDealt:m===1?150:100,totalDamageReceived:m===1?100:150,techniques:["화염지창","벽력일섬"],perfectStrikes:m===1?1:0,vitalPointHits:m===1?2:1,consecutiveWins:m===1?1:0,matchDuration:120}})},[]),w=x.useCallback(()=>{C(null),n(!1),p(null),o(null)},[]),g=()=>{if(l&&s)return e.jsx(x.Suspense,{fallback:e.jsx("div",{className:"loading-screen",children:"로딩 중..."}),children:e.jsx(De,{winner:l,matchStatistics:s,onReturnToMenu:w,onRestart:()=>_(a),width:T.width,height:T.height})});if(j&&a)switch(a){case O.TRAINING:return e.jsx(x.Suspense,{fallback:e.jsx("div",{className:"loading-screen",children:"로딩 중..."}),children:e.jsx(Ne,{player:r,onPlayerUpdate:y=>{},onReturnToMenu:w,width:T.width,height:T.height})});case O.VERSUS:case O.PRACTICE:const m=K(B.MUSA,0),c=K(B.AMSALJA,1);return e.jsx(ke,{players:[m,c],currentRound:1,timeRemaining:180,isPaused:!1,onPlayerUpdate:(y,R)=>{},onReturnToMenu:w,onGameEnd:d,gameMode:a,width:T.width,height:T.height});default:return e.jsx(Z,{onMenuSelect:_,width:T.width,height:T.height})}return e.jsx(Z,{onMenuSelect:_,width:T.width,height:T.height})},v=x.useRef(null);if(x.useEffect(()=>{v.current?.focus()},[S]),x.useEffect(()=>{const m=()=>{const c=window.innerWidth,y=window.innerHeight;h({width:c,height:y,isMobile:c<768,isTablet:c>=768&&c<1024,isDesktop:c>=1024})};return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]),!S)return e.jsx("div",{className:"app loading","data-testid":"app-container",children:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",color:"white",backgroundColor:"#1a1a2e"},children:"흑괘 로딩 중... Loading Black Trigram..."})});const r=K(B.MUSA,0);return e.jsx(ne,{children:e.jsxs("div",{className:"app",tabIndex:0,ref:v,style:{outline:"none",width:"100vw",height:"100vh",overflow:"hidden"},"data-testid":"app-container",children:[e.jsx(de,{width:T.width,height:T.height,backgroundColor:657935,antialias:!0,autoDensity:!0,resizeTo:window,children:g()}),e.jsxs("div",{className:"test-overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:100},"data-testid":"ui-overlay",children:[a===null&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"intro-screen","data-testid":"intro-screen",style:{pointerEvents:"none",width:"100%",height:"100%",position:"absolute"}}),e.jsx("button",{className:"training-button","data-testid":"training-button",style:{position:"absolute",top:T.isMobile?"65%":"60%",left:T.isMobile?"5%":"25%",padding:"12px 24px",backgroundColor:"rgba(0, 212, 255, 0.9)",color:"white",border:"2px solid #00d4ff",borderRadius:"8px",cursor:"pointer",pointerEvents:"auto",fontSize:T.isMobile?"14px":"16px",fontWeight:"bold",zIndex:50,boxShadow:"0 0 20px rgba(0, 212, 255, 0.5)",transform:"none",maxWidth:"200px"},onClick:()=>_(O.TRAINING),children:"훈련 모드 - Training"}),e.jsx("button",{className:"combat-button","data-testid":"combat-button",style:{position:"absolute",top:T.isMobile?"75%":"70%",left:T.isMobile?"5%":"25%",padding:"12px 24px",backgroundColor:"rgba(255, 107, 53, 0.9)",color:"white",border:"2px solid #ff6b35",borderRadius:"8px",cursor:"pointer",pointerEvents:"auto",fontSize:T.isMobile?"14px":"16px",fontWeight:"bold",zIndex:50,boxShadow:"0 0 20px rgba(255, 107, 53, 0.5)",transform:"none",maxWidth:"200px"},onClick:()=>_(O.VERSUS),children:"대전 모드 - Combat"})]}),a===O.TRAINING&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"training-screen","data-testid":"training-screen",style:{pointerEvents:"none",width:"100%",height:"100%",position:"absolute"}}),e.jsx("button",{"data-testid":"return-to-menu-button",style:{position:"absolute",bottom:"10%",right:"10%",padding:"10px 20px",backgroundColor:"rgba(74, 85, 104, 0.8)",color:"white",border:"2px solid #4a5568",borderRadius:"6px",cursor:"pointer",pointerEvents:"auto",fontSize:"14px",zIndex:50},onClick:w,children:"메뉴로 돌아가기 - Return to Menu"})]}),(a===O.VERSUS||a===O.PRACTICE)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"combat-screen","data-testid":"combat-screen",style:{pointerEvents:"none",width:"100%",height:"100%",position:"absolute"}}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"white",fontSize:"24px",fontWeight:"bold",pointerEvents:"none",zIndex:50},children:"Combat - 전투"}),e.jsx("button",{"data-testid":"return-to-menu-button",style:{position:"absolute",top:"20px",right:"20px",padding:"10px 20px",backgroundColor:"rgba(74, 85, 104, 0.8)",color:"white",border:"2px solid #4a5568",borderRadius:"6px",cursor:"pointer",pointerEvents:"auto",fontSize:"14px",zIndex:50},onClick:w,children:"메뉴"})]})]})]})})}const Ge=le.createRoot(document.getElementById("root"));Ge.render(e.jsx(L.StrictMode,{children:e.jsx(ne,{children:e.jsx(Ie,{})})}));document.title="흑괘 무술 도장 - Black Trigram Martial Arts";
